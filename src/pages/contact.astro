---
import BaseLayout from '../layouts/BaseLayout.astro';
import FooterWithMask from '../components/sections/FooterWithMask.astro';
---

<BaseLayout
  title="Contact | Walking With A Smile"
  description="Reach out when you're ready. No pressure. Connect with us for support, questions, or just to explore your options."
  hideFooter={true}
>
  <!-- Hero Section -->
  <section class="contact-hero bg-alt">
    <div class="container container-6xl">
      <div class="hero-content">
        <h1 class="hero-title">Get in touch</h1>
        <p class="hero-subtitle">Reach out when you're ready. No pressure.</p>
        <div class="hero-text">
          <p>
            Whether you have a question, want to explore your options, or just need a bit more information before deciding anything, we're here.
          </p>
          <p>
            This isn't a sales conversation. It's a chance to connect and see what might be useful for you. You can choose to use the form below or email us directly at <a href="mailto:hello@walkingwithasmile.com" class="hero-email-link">hello@walkingwithasmile.com</a>.
          </p>
          <p>
            We aim to respond within 2 working days. If you'd prefer a conversation, let us know and we can arrange a time that works for you.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact Form Section -->
  <section class="contact-section section bg-alt">
    <div class="container container-7xl">
      <form id="contact-form" class="contact-form">
        <div class="form-grid">
          <!-- Left Column: Name, Email, Subject -->
          <div class="form-left">
            <!-- Name Field -->
            <div class="form-group">
              <label for="name" class="form-label">Name</label>
              <input
                type="text"
                id="name"
                name="name"
                class="form-input"
                required
                aria-required="true"
              />
            </div>

            <!-- Email Field -->
            <div class="form-group">
              <label for="email" class="form-label">Email</label>
              <input
                type="email"
                id="email"
                name="email"
                class="form-input"
                required
                aria-required="true"
              />
            </div>

            <!-- Subject Field -->
            <div class="form-group">
              <label for="subject" class="form-label">Subject</label>
              <input
                type="text"
                id="subject"
                name="subject"
                class="form-input"
                required
                aria-required="true"
              />
            </div>
          </div>

          <!-- Right Column: Message -->
          <div class="form-right">
            <div class="form-group form-group-full">
              <label for="message" class="form-label">
                What's on your mind? <span class="optional-text">(optional: share as much or as little as you like)</span>
              </label>
              <textarea
                id="message"
                name="message"
                class="form-textarea"
                rows="6"
                aria-describedby="message-help"
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Submit Button -->
        <div class="form-actions">
          <button type="submit" class="btn btn-primary btn-lg">
            Send Message
          </button>
        </div>
      </form>
    </div>
  </section>

  <!-- Footer with Interactive Mask -->
  <FooterWithMask
    backgroundImage="/Footer/Footer Background.jpg"
    height="400px"
  />
</BaseLayout>

<style>
  /* Common styles */
  .section {
    padding: var(--space-5xl) 0;
  }

  /* Hero Section - uses bg-alt class for background */
  .contact-hero {
    position: relative;
    width: 100%;
    padding-top: calc(100px + var(--space-3xl));
    padding-bottom: var(--space-4xl);
  }

  .hero-content {
    text-align: left;
    max-width: 800px;
  }

  .hero-title {
    font-family: var(--font-heading);
    font-size: clamp(3rem, 8vw, 5rem);
    font-weight: var(--font-extrabold);
    color: var(--color-Text-700);
    margin-bottom: var(--space-xl);
    line-height: 0.95;
    letter-spacing: -0.02em;
  }

  .hero-subtitle {
    font-family: var(--font-body);
    font-size: var(--text-xl);
    font-weight: var(--font-medium);
    color: var(--color-Text-600);
    line-height: var(--leading-relaxed);
    margin-bottom: var(--space-lg);
  }

  .hero-text {
    max-width: 700px;
  }

  .hero-text p {
    font-size: var(--text-base);
    color: var(--color-Text-600);
    line-height: var(--leading-relaxed);
    margin-bottom: var(--space-md);
  }

  .hero-email-link {
    color: var(--color-Primary-600);
    text-decoration: underline;
    transition: color 0.2s ease;
  }

  .hero-email-link:hover {
    color: var(--color-Primary-700);
  }

  /* Contact Section */
  .contact-section {
    padding: var(--space-5xl) 0;
  }

  /* Contact Form */
  .contact-form {
    background: var(--color-AccentThree-200);
    padding: var(--space-xl);
    border-radius: var(--border-radius-lg);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  }

  .form-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-xl);
  }

  @media (min-width: 768px) {
    .form-grid {
      grid-template-columns: 1fr 1fr;
      gap: var(--space-2xl);
    }
  }

  .form-left,
  .form-right {
    display: flex;
    flex-direction: column;
  }

  .form-group {
    margin-bottom: var(--space-lg);
  }

  .form-group-full {
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  .form-group-full .form-textarea {
    flex: 1;
    min-height: 250px;
  }

  .form-label {
    display: block;
    font-size: var(--text-base);
    font-weight: var(--font-semibold);
    color: var(--color-Text-700);
    margin-bottom: var(--space-sm);
  }

  .optional-text {
    font-weight: var(--font-normal);
    color: var(--color-Text-500);
    font-size: var(--text-sm);
    font-style: italic;
  }

  .form-input,
  .form-select,
  .form-textarea {
    width: 100%;
    padding: var(--space-sm);
    font-size: var(--text-base);
    color: var(--color-Text-700);
    background-color: var(--color-Neutral-500);
    border: 2px solid var(--color-Neutral-200);
    border-radius: var(--border-radius-md);
    font-family: var(--font-body);
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
  }

  .form-input:focus,
  .form-select:focus,
  .form-textarea:focus {
    outline: none;
    border-color: var(--color-Primary-500);
    box-shadow: 0 0 0 3px color-mix(in srgb, var(--color-Primary-500) 15%, transparent);
  }

  .form-select {
    cursor: pointer;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right var(--space-md) center;
    padding-right: var(--space-3xl);
  }

  .form-textarea {
    resize: vertical;
    min-height: 150px;
    line-height: var(--leading-relaxed);
  }

  .form-actions {
    display: flex;
    justify-content: center;
    margin-top: var(--space-lg);
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .section {
      padding: var(--space-3xl) 0;
    }

    .contact-hero {
      padding-top: calc(80px + var(--space-2xl));
      padding-bottom: var(--space-3xl);
    }

    .hero-title {
      font-size: clamp(2.5rem, 10vw, 3.5rem);
    }

    .hero-subtitle {
      font-size: var(--text-lg);
    }

    .hero-text p {
      font-size: var(--text-sm);
    }

    .contact-form {
      padding: var(--space-lg);
    }

    .form-group {
      margin-bottom: var(--space-md);
    }
  }

  @media (max-width: 640px) {
    .contact-hero {
      padding-top: calc(80px + var(--space-xl));
      padding-bottom: var(--space-2xl);
    }

    .hero-title {
      font-size: clamp(2rem, 12vw, 2.5rem);
    }

    .hero-subtitle {
      font-size: var(--text-base);
    }

    .hero-text p {
      font-size: var(--text-sm);
    }
  }

  @media (max-width: 480px) {
    .contact-form {
      padding: var(--space-md);
    }

    .form-input,
    .form-textarea {
      padding: var(--space-xs);
      font-size: var(--text-sm);
    }
  }

  @media (max-width: 250px) {
    .contact-hero {
      padding-top: calc(70px + var(--space-lg));
      padding-bottom: var(--space-xl);
    }

    .hero-title {
      font-size: var(--text-2xl);
    }

    .hero-subtitle {
      font-size: var(--text-sm);
    }

    .hero-text p {
      font-size: var(--text-xs);
    }

    .hero-email-link {
      word-break: break-all;
      display: inline-block;
    }

    .contact-section {
      padding: var(--space-2xl) 0;
    }

    .contact-form {
      padding: var(--space-sm);
    }

    .form-group {
      margin-bottom: var(--space-sm);
    }

    .form-label {
      font-size: var(--text-sm);
    }

    .form-input,
    .form-textarea {
      padding: var(--space-xs);
      font-size: 0.75rem;
    }

    .form-actions .btn {
      width: 100%;
      font-size: var(--text-sm);
    }
  }

  /* Extra small screens */
  @media (max-width: 210px) {
    .contact-hero {
      padding-top: calc(60px + var(--space-md));
      padding-bottom: var(--space-lg);
    }

    .hero-title {
      font-size: var(--text-xl);
    }

    .hero-subtitle,
    .hero-text p {
      font-size: var(--text-xs);
    }
  }

  /* =========================================================
     ACCESSIBILITY THEME OVERRIDES
     ========================================================= */

  /* Dark mode: Transparent form with white text and accent border */
  body.a11y-theme-dark .contact-form {
    background: transparent !important;
    border: 2px solid var(--a11y-dark-accent) !important;
    box-shadow: none !important;
  }

  body.a11y-theme-dark .form-label,
  body.a11y-theme-dark .optional-text {
    color: var(--a11y-dark-text) !important;
  }

  body.a11y-theme-dark .form-input,
  body.a11y-theme-dark .form-textarea,
  body.a11y-theme-dark .form-select {
    background-color: color-mix(in srgb, var(--a11y-dark-text) 10%, transparent) !important;
    border-color: var(--a11y-dark-accent) !important;
    color: var(--a11y-dark-text) !important;
  }

  body.a11y-theme-dark .form-input::placeholder,
  body.a11y-theme-dark .form-textarea::placeholder {
    color: color-mix(in srgb, var(--a11y-dark-text) 50%, transparent) !important;
  }

  /* High Contrast: Pure white form for maximum contrast */
  body.a11y-theme-high-contrast .contact-form {
    background: #ffffff !important;
    border: 2px solid var(--a11y-hc-accent) !important;
    box-shadow: none !important;
  }

  body.a11y-theme-high-contrast .form-label {
    color: #000000 !important;
  }

  body.a11y-theme-high-contrast .optional-text {
    color: #333333 !important;
  }

  body.a11y-theme-high-contrast .form-input,
  body.a11y-theme-high-contrast .form-textarea,
  body.a11y-theme-high-contrast .form-select {
    background-color: #ffffff !important;
    border: 2px solid #000000 !important;
    color: #000000 !important;
  }

  /* Cream theme: Cream background with accent border */
  body.a11y-theme-cream .contact-form {
    background: var(--a11y-cream-bg) !important;
    border: 2px solid var(--a11y-cream-accent) !important;
    box-shadow: none !important;
  }

  body.a11y-theme-cream .form-label {
    color: var(--a11y-cream-text) !important;
  }

  body.a11y-theme-cream .optional-text {
    color: var(--a11y-cream-accent) !important;
  }

  body.a11y-theme-cream .form-input,
  body.a11y-theme-cream .form-textarea,
  body.a11y-theme-cream .form-select {
    background-color: #ffffff !important;
    border-color: var(--a11y-cream-accent) !important;
    color: var(--a11y-cream-text) !important;
  }

  /* Monochrome theme */
  body.a11y-theme-monochrome .contact-form,
  body.a11y-cvd-monochrome .contact-form {
    background: var(--a11y-mono-bg-100) !important;
    border: 2px solid #333333 !important;
    box-shadow: none !important;
  }

  body.a11y-theme-monochrome .form-label,
  body.a11y-theme-monochrome .optional-text,
  body.a11y-cvd-monochrome .form-label,
  body.a11y-cvd-monochrome .optional-text {
    color: #333333 !important;
  }

  body.a11y-theme-monochrome .form-input,
  body.a11y-theme-monochrome .form-textarea,
  body.a11y-theme-monochrome .form-select,
  body.a11y-cvd-monochrome .form-input,
  body.a11y-cvd-monochrome .form-textarea,
  body.a11y-cvd-monochrome .form-select {
    background-color: #ffffff !important;
    border-color: #333333 !important;
    color: #333333 !important;
  }

  /* CVD Color Blind modes: Transparent form with primary border */
  body.a11y-theme-protanopia .contact-form,
  body.a11y-theme-deuteranopia .contact-form,
  body.a11y-theme-tritanopia .contact-form,
  body.a11y-cvd-protanopia .contact-form,
  body.a11y-cvd-deuteranopia .contact-form,
  body.a11y-cvd-tritanopia .contact-form {
    background: transparent !important;
    border: 2px solid var(--color-Primary-600) !important;
    box-shadow: none !important;
  }

  body.a11y-theme-protanopia .form-label,
  body.a11y-theme-deuteranopia .form-label,
  body.a11y-theme-tritanopia .form-label,
  body.a11y-cvd-protanopia .form-label,
  body.a11y-cvd-deuteranopia .form-label,
  body.a11y-cvd-tritanopia .form-label {
    color: #000000 !important;
  }

  body.a11y-theme-protanopia .optional-text,
  body.a11y-theme-deuteranopia .optional-text,
  body.a11y-theme-tritanopia .optional-text,
  body.a11y-cvd-protanopia .optional-text,
  body.a11y-cvd-deuteranopia .optional-text,
  body.a11y-cvd-tritanopia .optional-text {
    color: var(--color-Primary-600) !important;
  }

  body.a11y-theme-protanopia .form-input,
  body.a11y-theme-protanopia .form-textarea,
  body.a11y-theme-protanopia .form-select,
  body.a11y-theme-deuteranopia .form-input,
  body.a11y-theme-deuteranopia .form-textarea,
  body.a11y-theme-deuteranopia .form-select,
  body.a11y-theme-tritanopia .form-input,
  body.a11y-theme-tritanopia .form-textarea,
  body.a11y-theme-tritanopia .form-select,
  body.a11y-cvd-protanopia .form-input,
  body.a11y-cvd-protanopia .form-textarea,
  body.a11y-cvd-protanopia .form-select,
  body.a11y-cvd-deuteranopia .form-input,
  body.a11y-cvd-deuteranopia .form-textarea,
  body.a11y-cvd-deuteranopia .form-select,
  body.a11y-cvd-tritanopia .form-input,
  body.a11y-cvd-tritanopia .form-textarea,
  body.a11y-cvd-tritanopia .form-select {
    background-color: rgba(255, 255, 255, 0.9) !important;
    border-color: var(--color-Primary-600) !important;
    color: #000000 !important;
  }
</style>

<script>
  // Handle form submission
  const form = document.getElementById('contact-form') as HTMLFormElement;

  if (form) {
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      // Show loading state
      const submitButton = form.querySelector('button[type="submit"]') as HTMLButtonElement;
      const originalText = submitButton.textContent;
      submitButton.disabled = true;
      submitButton.textContent = 'Sending...';

      try {
        // TODO: Replace with actual form submission endpoint
        // For now, we'll simulate a successful submission
        await new Promise(resolve => setTimeout(resolve, 1000));

        // Show success message
        if ((window as any).showToast) {
          (window as any).showToast('Message sent successfully! We\'ll get back to you soon.', 'success');
        }

        // Reset form
        form.reset();
      } catch (error) {
        // Show error message
        if ((window as any).showToast) {
          (window as any).showToast('Something went wrong. Please try again or email us directly.', 'error');
        }
      } finally {
        // Restore button state
        submitButton.disabled = false;
        submitButton.textContent = originalText;
      }
    });
  }
</script>
