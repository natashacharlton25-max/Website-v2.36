---
import BaseLayout from '../../layouts/BaseLayout.astro';

// Export getStaticPaths for static site generation
export async function getStaticPaths() {
  // TODO: In production, fetch resources from your database/API
  return [
    { params: { slug: 'getting-started-template' } },
    { params: { slug: 'social-media-kit' } },
    { params: { slug: 'email-templates' } },
  ];
}

// TODO: In production, fetch resource data based on slug from database/API
const { slug } = Astro.params;

// Placeholder resource data - images removed until real content is added
const resource = {
  id: '1',
  name: 'Getting Started Template',
  slug: slug,
  type: 'Template',
  description: 'A comprehensive template to help you kickstart your project with all the essential components and best practices.',
  longDescription: `
    <p>This comprehensive template includes everything you need to start your project on the right foot. We've included best practices, proven structures, and customizable components that have been tested and refined over years of experience.</p>
    <p>Whether you're a beginner or an experienced professional, this template will save you hours of setup time and ensure you're building on a solid foundation from day one.</p>
  `,
  features: [
    'Complete project structure',
    'Best practices built-in',
    'Easy to customize',
    'Well-documented',
    'Regular updates',
    'Community support',
    'Mobile-friendly design',
    'No attribution required'
  ],
  downloads: 1200,
  fileSize: '2.4 MB',
  fileFormat: 'PDF',
  lastUpdated: 'January 15, 2025',
  image: '', // TODO: Add image when available
  downloadUrl: '#' // TODO: Add actual download URL
};

// Related resources - empty until real content is added
const relatedResources: Array<{id: string; name: string; slug: string; type: string; image: string; downloads: number}> = [];
---

<BaseLayout
  title={`${resource.name} - Free Download | Your Brand Name`}
  description={resource.description}
>
  <!-- Breadcrumbs -->
  <section class="breadcrumbs-section">
    <div class="container container-7xl">
      <nav class="breadcrumbs">
        <a href="/">Home</a>
        <span class="separator">›</span>
        <a href="/for-you">Free Resources</a>
        <span class="separator">›</span>
        <span class="current">{resource.name}</span>
      </nav>
    </div>
  </section>

  <!-- Resource Hero -->
  <section class="resource-hero-section section">
    <div class="container container-7xl">
      <div class="resource-hero-layout">
        <!-- Left: Resource Image -->
        <div class="resource-hero-image">
          <img src={resource.image} alt={resource.name} />
          <div class="resource-type-badge">{resource.type}</div>
        </div>

        <!-- Right: Resource Info -->
        <div class="resource-hero-content">
          <div class="resource-type">{resource.type}</div>
          <h1 class="resource-title">{resource.name}</h1>
          <p class="resource-description">{resource.description}</p>

          <!-- Resource Stats -->
          <div class="resource-stats">
            <div class="stat-item">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7 10 12 15 17 10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
              </svg>
              <div>
                <strong>{resource.downloads.toLocaleString()}</strong>
                <span>Downloads</span>
              </div>
            </div>
            <div class="stat-item">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <polyline points="14 2 14 8 20 8"/>
              </svg>
              <div>
                <strong>{resource.fileSize}</strong>
                <span>{resource.fileFormat}</span>
              </div>
            </div>
            <div class="stat-item">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12 6 12 12 16 14"/>
              </svg>
              <div>
                <strong>Updated</strong>
                <span>{resource.lastUpdated}</span>
              </div>
            </div>
          </div>

          <!-- Download Section -->
          <div class="download-section card">
            <div class="download-header">
              <div class="download-icon">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="7 10 12 15 17 10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
              </div>
              <div>
                <h3 class="download-title">Free Download</h3>
                <p class="download-subtitle">No signup required</p>
              </div>
            </div>

            <form class="download-form" id="download-form">
              <input
                type="email"
                name="email"
                placeholder="Enter your email (optional)"
                class="download-input"
              />
              <button type="submit" class="btn btn-primary btn-lg btn-block">
                Download Now
              </button>
            </form>

            <div class="download-info">
              <p class="download-note">
                By downloading, you agree to our
                <a href="/legal/terms">Terms of Use</a>
              </p>
            </div>
          </div>

          <!-- Share -->
          <div class="resource-share">
            <span class="share-label">Share this resource:</span>
            <div class="share-buttons">
              <button type="button" class="share-btn" title="Share on Twitter">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z"/>
                </svg>
              </button>
              <button type="button" class="share-btn" title="Share on Facebook">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/>
                </svg>
              </button>
              <button type="button" class="share-btn" title="Share on LinkedIn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6zM2 9h4v12H2z"/>
                  <circle cx="4" cy="4" r="2"/>
                </svg>
              </button>
              <button type="button" class="share-btn" title="Copy link">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/>
                  <path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Resource Details -->
  <section class="resource-details-section section-sm bg-alt">
    <div class="container container-6xl">
      <div class="details-card card">
        <h2 class="details-title">About This Resource</h2>
        <div class="details-content" set:html={resource.longDescription} />

        <h3 class="details-subtitle">What's Included</h3>
        <ul class="features-list">
          {resource.features.map(feature => (
            <li>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
              <span>{feature}</span>
            </li>
          ))}
        </ul>

        <div class="details-footer">
          <a href="#download-form" class="btn btn-primary">
            Download This Resource
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Related Resources -->
  <section class="related-resources-section section">
    <div class="container container-7xl">
      <h2 class="section-title">You May Also Like</h2>
      <div class="related-grid">
        {relatedResources.map(relatedResource => (
          <div class="resource-card card">
            <div class="resource-image">
              <img src={relatedResource.image} alt={relatedResource.name} />
              <div class="resource-type-badge">{relatedResource.type}</div>
            </div>
            <div class="resource-content">
              <h3 class="resource-name">
                <a href={`/for-you/${relatedResource.slug}`}>{relatedResource.name}</a>
              </h3>
              <div class="resource-downloads">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="7 10 12 15 17 10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                <span>{relatedResource.downloads.toLocaleString()} downloads</span>
              </div>
              <a href={`/for-you/${relatedResource.slug}`} class="btn btn-outline btn-sm btn-block">
                View Details
              </a>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Newsletter CTA -->
  <section class="newsletter-cta-section section bg-alt">
    <div class="container container-5xl text-center">
      <h2 class="cta-title">Get More Free Resources</h2>
      <p class="cta-description">
        Subscribe to our newsletter and be the first to know about new free resources
      </p>
      <form class="newsletter-form" id="newsletter-form">
        <input
          type="email"
          placeholder="Enter your email"
          class="newsletter-input"
          required
        />
        <button type="submit" class="btn btn-primary">Subscribe</button>
      </form>
    </div>
  </section>
</BaseLayout>

<script>
  // Download form handling
  const downloadForm = document.getElementById('download-form');
  if (downloadForm) {
    downloadForm.addEventListener('submit', (e) => {
      e.preventDefault();

      // TODO: Implement actual download logic
      // For now, just simulate download
      if (window.showToast) {
        window.showToast({
          type: 'success',
          message: 'Your download will begin shortly!',
          duration: 3000
        });
      }

      // Simulate download after a brief delay
      setTimeout(() => {
        // In production, trigger actual file download here
        window.alert('Download functionality: In production, the file would download here.');
      }, 1000);
    });
  }

  // Share functionality
  const shareButtons = document.querySelectorAll('.share-btn');
  shareButtons.forEach((btn, index) => {
    btn.addEventListener('click', () => {
      const url = window.location.href;

      if (index === 3) { // Copy link button
        navigator.clipboard.writeText(url);
        if (window.showToast) {
          window.showToast({
            type: 'success',
            message: 'Link copied to clipboard!',
            duration: 2000
          });
        }
      }
    });
  });

  // Newsletter form
  const newsletterForm = document.getElementById('newsletter-form');
  if (newsletterForm) {
    newsletterForm.addEventListener('submit', (e) => {
      e.preventDefault();
      if (window.showToast) {
        window.showToast({
          type: 'success',
          message: 'Thanks for subscribing!',
          duration: 3000
        });
      }
      newsletterForm.reset();
    });
  }
</script>

<style>
  /* Breadcrumbs */
  .breadcrumbs-section {
    padding: var(--space-lg) 0;
    background: var(--color-Background-100);
  }

  .breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    font-size: var(--text-sm);
  }

  .breadcrumbs a {
    color: var(--brand-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
  }

  .breadcrumbs a:hover {
    color: var(--brand-primary);
  }

  .breadcrumbs .separator {
    color: var(--brand-text-muted);
  }

  .breadcrumbs .current {
    color: var(--brand-text);
    font-weight: var(--font-semibold);
  }

  /* Resource Hero */
  .resource-hero-layout {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-3xl);
  }

  .resource-hero-image {
    position: relative;
    width: 100%;
    aspect-ratio: 16 / 10;
    border-radius: var(--border-radius-lg);
    overflow: hidden;
    background: var(--brand-neutral-100);
    box-shadow: var(--shadow-xl);
  }

  .resource-hero-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .resource-type-badge {
    position: absolute;
    top: var(--space-lg);
    left: var(--space-lg);
    padding: var(--space-sm) var(--space-lg);
    background: var(--brand-primary);
    color: white;
    font-size: var(--text-sm);
    font-weight: var(--font-bold);
    border-radius: var(--border-radius-full);
    text-transform: uppercase;
  }

  .resource-hero-content {
    display: flex;
    flex-direction: column;
    gap: var(--space-lg);
  }

  .resource-type {
    font-size: var(--text-sm);
    color: var(--brand-primary);
    font-weight: var(--font-semibold);
    text-transform: uppercase;
  }

  .resource-title {
    font-size: var(--text-4xl);
    font-weight: var(--font-bold);
    color: var(--brand-text);
    line-height: var(--leading-tight);
  }

  .resource-description {
    font-size: var(--text-lg);
    color: var(--brand-text-muted);
    line-height: var(--leading-relaxed);
  }

  .resource-stats {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-md);
    padding: var(--space-lg);
    background: var(--color-Background-100);
    border-radius: var(--border-radius-md);
  }

  .stat-item {
    display: flex;
    align-items: center;
    gap: var(--space-md);
  }

  .stat-item svg {
    color: var(--brand-primary);
    flex-shrink: 0;
  }

  .stat-item div {
    display: flex;
    flex-direction: column;
  }

  .stat-item strong {
    font-size: var(--text-base);
    font-weight: var(--font-bold);
    color: var(--brand-text);
  }

  .stat-item span {
    font-size: var(--text-sm);
    color: var(--brand-text-muted);
  }

  /* Download Section */
  .download-section {
    padding: var(--space-xl);
  }

  .download-header {
    display: flex;
    align-items: center;
    gap: var(--space-md);
    margin-bottom: var(--space-lg);
  }

  .download-icon {
    width: 60px;
    height: 60px;
    background: var(--brand-primary-light);
    border-radius: var(--border-radius-full);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--brand-primary);
    flex-shrink: 0;
  }

  .download-title {
    font-size: var(--text-xl);
    font-weight: var(--font-bold);
    color: var(--brand-text);
    margin-bottom: var(--space-xs);
  }

  .download-subtitle {
    font-size: var(--text-sm);
    color: var(--brand-text-muted);
    margin: 0;
  }

  .download-form {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
    margin-bottom: var(--space-md);
  }

  .download-input {
    padding: var(--space-md);
    border: 1px solid var(--brand-neutral-300);
    border-radius: var(--border-radius-md);
    font-size: var(--text-base);
  }

  .btn-block {
    width: 100%;
  }

  .download-info {
    padding-top: var(--space-md);
    border-top: 1px solid var(--brand-neutral-200);
  }

  .download-note {
    font-size: var(--text-xs);
    color: var(--brand-text-muted);
    text-align: center;
    margin: 0;
  }

  .download-note a {
    color: var(--brand-primary);
  }

  /* Share */
  .resource-share {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
    align-items: center;
  }

  .share-label {
    font-size: var(--text-sm);
    font-weight: var(--font-semibold);
    color: var(--brand-text);
  }

  .share-buttons {
    display: flex;
    gap: var(--space-sm);
  }

  .share-btn {
    width: 36px;
    height: 36px;
    border: 1px solid var(--brand-neutral-300);
    border-radius: var(--border-radius-md);
    background: white;
    color: var(--brand-text-muted);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition-fast);
  }

  .share-btn:hover {
    background: var(--brand-primary);
    border-color: var(--brand-primary);
    color: white;
  }

  /* Resource Details - .bg-alt uses global class from utilities.css */

  .details-card {
    padding: var(--space-3xl);
  }

  .details-title {
    font-size: var(--text-3xl);
    font-weight: var(--font-bold);
    margin-bottom: var(--space-lg);
    color: var(--brand-text);
  }

  .details-content {
    color: var(--brand-text-muted);
    line-height: var(--leading-relaxed);
    margin-bottom: var(--space-2xl);
  }

  .details-content p {
    margin-bottom: var(--space-lg);
  }

  .details-subtitle {
    font-size: var(--text-2xl);
    font-weight: var(--font-bold);
    margin-bottom: var(--space-lg);
    color: var(--brand-text);
  }

  .features-list {
    list-style: none;
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-md);
    margin-bottom: var(--space-2xl);
  }

  .features-list li {
    display: flex;
    align-items: center;
    gap: var(--space-md);
    padding: var(--space-md);
    background: white;
    border-radius: var(--border-radius-md);
  }

  .features-list svg {
    color: var(--brand-success);
    flex-shrink: 0;
  }

  .details-footer {
    padding-top: var(--space-xl);
    border-top: 1px solid var(--brand-neutral-200);
    text-align: center;
  }

  /* Related Resources */
  .section-title {
    font-size: var(--text-3xl);
    font-weight: var(--font-bold);
    margin-bottom: var(--space-2xl);
    color: var(--brand-text);
  }

  .related-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-xl);
  }

  .resource-card {
    overflow: hidden;
    transition: all var(--transition-base);
  }

  .resource-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-xl);
  }

  .resource-card .resource-image {
    position: relative;
    aspect-ratio: 16 / 9;
    overflow: hidden;
    background: var(--brand-neutral-100);
  }

  .resource-card .resource-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--transition-base);
  }

  .resource-card:hover .resource-image img {
    transform: scale(1.05);
  }

  .resource-card .resource-type-badge {
    top: var(--space-md);
    left: var(--space-md);
    padding: var(--space-xs) var(--space-md);
    font-size: var(--text-xs);
  }

  .resource-card .resource-content {
    padding: var(--space-lg);
  }

  .resource-card .resource-name {
    font-size: var(--text-lg);
    font-weight: var(--font-bold);
    margin-bottom: var(--space-sm);
  }

  .resource-card .resource-name a {
    color: var(--brand-text);
    text-decoration: none;
    transition: color var(--transition-fast);
  }

  .resource-card .resource-name a:hover {
    color: var(--brand-primary);
  }

  .resource-downloads {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
    font-size: var(--text-sm);
    color: var(--brand-text-muted);
    margin-bottom: var(--space-md);
  }

  .resource-downloads svg {
    color: var(--brand-primary);
  }

  /* Newsletter CTA */
  .cta-title {
    font-size: var(--text-3xl);
    font-weight: var(--font-bold);
    margin-bottom: var(--space-md);
    color: var(--brand-text);
  }

  .cta-description {
    font-size: var(--text-lg);
    color: var(--brand-text-muted);
    margin-bottom: var(--space-xl);
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  .newsletter-form {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
    max-width: 500px;
    margin: 0 auto;
  }

  .newsletter-input {
    padding: var(--space-md);
    border: 1px solid var(--brand-neutral-300);
    border-radius: var(--border-radius-md);
    font-size: var(--text-base);
  }

  /* Responsive: Tablet */
  @media (min-width: 768px) {
    .resource-hero-layout {
      grid-template-columns: 1fr 1fr;
    }

    .resource-stats {
      grid-template-columns: repeat(3, 1fr);
    }

    .resource-share {
      flex-direction: row;
      justify-content: space-between;
    }

    .features-list {
      grid-template-columns: repeat(2, 1fr);
    }

    .related-grid {
      grid-template-columns: repeat(2, 1fr);
    }

    .newsletter-form {
      flex-direction: row;
    }

    .newsletter-input {
      flex: 1;
    }
  }

  /* Responsive: Desktop */
  @media (min-width: 1024px) {
    .resource-title {
      font-size: var(--text-5xl);
    }

    .related-grid {
      grid-template-columns: repeat(3, 1fr);
    }

    .cta-title {
      font-size: var(--text-4xl);
    }
  }
</style>
