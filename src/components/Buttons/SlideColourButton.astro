---
/** SlideColourButton.astro (Token-Mapped, fixed icon) */
import '../../styles/Glassmorphic.css';
import '../../styles/GlowTokens.css';
import '../../styles/Gradient.css';

import DrawSVGIcon from '../animations/DrawSVGIcon.astro';
import MorphSVGIcon from '../animations/MorphSVGIcon.astro';

export interface Props {
  label?: string;
  href?: string;
  target?: string;
  variant?: 'primary' | 'secondary' | 'accent1' | 'accent2' | 'accent3' | 'accent4' | 'accent5' |
            'slide-primary' | 'slide-secondary' | 'slide-accent1' | 'slide-accent2' | 'slide-accent3' | 'slide-accent4' | 'slide-accent5' |
            'chachaslide-primary' | 'chachaslide-secondary' | 'chachaslide-accent1' | 'chachaslide-accent2' | 'chachaslide-accent3' | 'chachaslide-accent4' | 'chachaslide-accent5' |
            'glassmorphic-primary' | 'glassmorphic-secondary' | 'glassmorphic-accent1' | 'glassmorphic-accent2' | 'glassmorphic-accent3' | 'glassmorphic-accent4' | 'glassmorphic-accent5' |
            'neumorphic-primary' | 'neumorphic-secondary' | 'neumorphic-accent1' | 'neumorphic-accent2' | 'neumorphic-accent3' | 'neumorphic-accent4' | 'neumorphic-accent5' |
            'gradient-primary' | 'gradient-secondary' | 'gradient-accent1' | 'gradient-accent2' | 'gradient-accent3' | 'gradient-accent4' | 'gradient-accent5' |
            'glow-primary' | 'glow-secondary' | 'glow-accent1' | 'glow-accent2' | 'glow-accent3' | 'glow-accent4' | 'glow-accent5';
  icon?: 'plus' | 'animated-plus' | 'animated-star' | 'animated-chevron';
  svgIcon?: any; // For imported SVG icons
  morphTarget?: string; // Target SVG for morph animation
  drawVariant?: 'draw' | 'drawcenter' | 'chachaslide' | 'flashgordon' | 'rainbowchase' | 'pulse'; // DrawSVGIcon variant
  useMorph?: boolean; // Use MorphSVGIcon instead of DrawSVGIcon
}

const {
  label = 'DOWNLOAD REALLY LONG FILE NAME HERE',
  href = 'https://example.com',
  target = '_blank',
  variant = 'primary',
  icon = 'plus',
  svgIcon,
  morphTarget,
  drawVariant,
  useMorph = false
} = Astro.props;
---
<div class="scb-container">
  <a
    class={`scb-button scb-button--${variant}`}
    href={href}
    target={target}
    rel="noopener noreferrer"
  >
    <span class="scb-circle" aria-hidden="true">
      {useMorph && svgIcon && morphTarget ? (
        <MorphSVGIcon
          svgIcon={svgIcon}
          morphTarget={morphTarget}
          class="scb-morph-icon"
        />
      ) : drawVariant && svgIcon ? (
        <DrawSVGIcon
          variant={drawVariant}
          svgIcon={svgIcon}
          class="scb-draw-icon"
        />
      ) : (variant?.startsWith('chachaslide-') || variant?.startsWith('glassmorphic-') || variant?.startsWith('neumorphic-') || variant?.startsWith('gradient-') || variant?.startsWith('glow-')) && svgIcon ? (
        <span class="scb-svg-icon" set:html={svgIcon}></span>
      ) : icon.startsWith('animated-') ? (
        <div class={`scb-lottie scb-${icon}`} data-animation={icon}></div>
      ) : (
        <>
          <span class={`scb-icon scb-${icon}`}></span>
          <span class="scb-icon scb-arrow"></span>
        </>
      )}
    </span>
    <span class="scb-button-text">{label}</span>
  </a>
</div>

<style>
 /* ---- Add near the top of <style> ---- */
:root {
  --scb-circle-size: 3rem;
  --scb-icon-size: 1rem;
}

/* Button base - overflow visible to allow effects to extend beyond bounds */
.scb-button {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  border: 0;
  text-decoration: none;
  background: transparent;
  font: inherit;

  padding: 1.6rem 2rem 1.6rem 3.5rem;
  overflow: visible;
}

/* Layering: circle at 0, icon at 1, text at 2 */
.scb-circle { z-index: 0; }
.scb-icon   { z-index: 1; }
.scb-button-text { z-index: 2; }

/* Circle anchored left, expands right */
.scb-circle {
  position: absolute;
  inset: 0 auto 0 0;
  width: var(--scb-circle-size);
  height: var(--scb-circle-size);
  margin: auto 0;
  border-radius: 999px;
  transition: width 0.45s cubic-bezier(0.65,0,.076,1),
              background 0.3s ease;
  will-change: width;
}

/* Icon locked to the circle centre */
.scb-icon {
  position: absolute;
  top: 50%;
  left: calc(var(--scb-circle-size) / 2);
  width: var(--scb-icon-size);
  height: var(--scb-icon-size);
  transform: translate(-50%, -50%);
  transition: transform 0.45s cubic-bezier(0.65,0,.076,1), opacity 0.2s ease;
  pointer-events: none;
  /* Default colour fallback ensures visibility even if tokens are missing */
  color: var(--color-Background-50, #fff);
}

/* Draw the plus with currentColor (never transparent if token missing) */
.scb-plus::before,
.scb-plus::after {
  content: '';
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  background: currentColor;
  border-radius: 2px;
}
.scb-plus::before { width: var(--scb-icon-size); height: 0.125rem; } /* horizontal */
.scb-plus::after  { width: 0.125rem; height: var(--scb-icon-size); } /* vertical */


/* ============================================
   ANIMATED LOTTIE ICONS
   ============================================ */

/* Lottie container styling */
.scb-lottie {
  position: absolute;
  top: 50%;
  left: calc(var(--scb-circle-size) / 2);
  width: calc(var(--scb-icon-size) * 2); /* Make icons bigger */
  height: calc(var(--scb-icon-size) * 2);
  transform: translate(-50%, -50%);
  transition: none; /* Remove transitions for animated icons */
  pointer-events: none;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Lottie SVG styling */
.scb-lottie svg {
  width: 100%;
  height: 100%;
  color: var(--color-Background-50, #fff);
}

/* High-specificity SVG color overrides for Lottie - no !important needed */
.scb-button .scb-circle .scb-lottie svg path {
  fill: white;
  stroke: white;
  stroke-width: 3;
}

.scb-button .scb-circle .scb-lottie svg g path {
  fill: white;
  stroke: white;
  stroke-width: 3;
}

.scb-button .scb-circle .scb-lottie svg rect,
.scb-button .scb-circle .scb-lottie svg circle,
.scb-button .scb-circle .scb-lottie svg polygon,
.scb-button .scb-circle .scb-lottie svg polyline,
.scb-button .scb-circle .scb-lottie svg line,
.scb-button .scb-circle .scb-lottie svg ellipse {
  fill: white;
  stroke: white;
  stroke-width: 3;
}

/* Preserve transparent elements */
.scb-button .scb-circle .scb-lottie svg *[fill="none"] {
  fill: none;
}

.scb-button .scb-circle .scb-lottie svg *[stroke="none"] {
  stroke: none;
}

/* CSS filter approach as backup */
.scb-button .scb-circle .scb-lottie svg {
  filter: brightness(0) saturate(100%) invert(100%) contrast(100%);
}

/* Ensure Lottie icons stay properly positioned */
.scb-lottie {
  opacity: 1;
  z-index: 2; /* Above circle background */
}

/* Animated icons stay visible and centered on hover */
.scb-button:hover .scb-lottie {
  transform: translate(-50%, -50%);
  opacity: 1;
}

/* SVG Icon container for ChaChaSlide variants */
.scb-svg-icon {
  position: absolute;
  top: 50%;
  left: calc(var(--scb-circle-size) / 2);
  width: calc(var(--scb-icon-size) * 1.5);
  height: calc(var(--scb-icon-size) * 1.5);
  transform: translate(-50%, -50%);
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
}

/* Center DrawSVGIcon and MorphSVGIcon components */
.scb-circle > :global(.scb-draw-icon),
.scb-circle > :global(.scb-morph-icon) {
  position: absolute;
  top: 50%;
  left: calc(var(--scb-circle-size) / 2);
  transform: translate(-50%, -50%);
  width: calc(var(--scb-icon-size) * 1.5);
  height: calc(var(--scb-icon-size) * 1.5);
  color: var(--color-Background-50, #fff);
  stroke: var(--color-Background-50, #fff);
  stroke-width: 1.5;
}

/* DrawSVGIcon uses inherited stroke */
.scb-circle > :global(.scb-draw-icon) {
  fill: none;
  --icon-primary-color: currentColor;
}

/* MorphSVGIcon uses inherited fill */
.scb-circle > :global(.scb-morph-icon) {
  fill: var(--color-Background-50, #fff);
  --icon-primary-color: var(--color-Background-50, #fff);
}

.scb-svg-icon svg {
  width: 100%;
  height: 100%;
}

/* SVG path animation - stroke drawing effect */
.scb-svg-icon :global(path),
.scb-svg-icon :global(circle),
.scb-svg-icon :global(rect),
.scb-svg-icon :global(line),
.scb-svg-icon :global(polyline),
.scb-svg-icon :global(polygon) {
  stroke: var(--color-Background-50, #fff);
  fill: none;
  stroke-width: 1.5;
}

/* Rainbow Chase - Animated gradient keyframes */
@keyframes rainbowChase {
  0% { stroke-dashoffset: 0; }
  100% { stroke-dashoffset: -200%; }
}

.scb-arrow {
  opacity: 0;
}

.scb-arrow::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0.6em;
  height: 0.6em;
  border-top: 0.125rem solid currentColor;
  border-right: 0.125rem solid currentColor;
  transform: translate(-75%, -50%) rotate(45deg);
}

/* Text spacing and colour */
.scb-button-text {
  position: relative;
  padding-right: 1rem;
  font-weight: var(--font-weight-medium);
  font-size: var(--font-size-base);
  text-transform: uppercase;
  font-family: var(--font-body);
  letter-spacing: 0.1em;
  color: var(--color-Text-700);
  transition: color 0.3s ease;
}

/* Variants: set circle fill + ensure icon contrast (white by default) */
.scb-button--primary   .scb-circle { background: var(--color-Primary-600); }
.scb-button--secondary .scb-circle { background: var(--color-Secondary-600); }
.scb-button--accent1   .scb-circle { background: var(--color-AccentOne-600); }
.scb-button--accent2   .scb-circle { background: var(--color-AccentTwo-600); }
.scb-button--accent3   .scb-circle { background: var(--color-AccentThree-600); }
.scb-button--accent4   .scb-circle { background: var(--color-AccentFour-600); }
.scb-button--accent5   .scb-circle { background: var(--color-AccentFive-600); }

/* Slide variants */
.scb-button--slide-primary   .scb-circle { background: var(--color-Primary-600); }
.scb-button--slide-secondary .scb-circle { background: var(--color-Secondary-600); }
.scb-button--slide-accent1   .scb-circle { background: var(--color-AccentOne-600); }
.scb-button--slide-accent2   .scb-circle { background: var(--color-AccentTwo-600); }
.scb-button--slide-accent3   .scb-circle { background: var(--color-AccentThree-600); }
.scb-button--slide-accent4   .scb-circle { background: var(--color-AccentFour-600); }
.scb-button--slide-accent5   .scb-circle { background: var(--color-AccentFive-600); }

/* ChaChaSlide variants - animated SVG icons */
.scb-button--chachaslide-primary   .scb-circle { background: var(--color-Primary-600); }
.scb-button--chachaslide-secondary .scb-circle { background: var(--color-Secondary-600); }
.scb-button--chachaslide-accent1   .scb-circle { background: var(--color-AccentOne-600); }
.scb-button--chachaslide-accent2   .scb-circle { background: var(--color-AccentTwo-600); }
.scb-button--chachaslide-accent3   .scb-circle { background: var(--color-AccentThree-600); }
.scb-button--chachaslide-accent4   .scb-circle { background: var(--color-AccentFour-600); }
.scb-button--chachaslide-accent5   .scb-circle { background: var(--color-AccentFive-600); }

/* Glassmorphic variants - neumorphic glass style with semi-transparent bg and inset shadows */
.scb-button--glassmorphic-primary .scb-circle {
  background: color-mix(in srgb, var(--color-Primary-500) 25%, var(--glass-surface-bg));
  color: var(--color-Primary-800);
  backdrop-filter: blur(var(--glass-surface-blur));
  -webkit-backdrop-filter: blur(var(--glass-surface-blur));
  border: 1px solid color-mix(in srgb, var(--color-Primary-400) 30%, transparent);
  box-shadow:
    inset 2px 2px 4px color-mix(in srgb, var(--color-Primary-700) 15%, transparent),
    inset -2px -2px 4px color-mix(in srgb, var(--color-Primary-100) 20%, transparent),
    var(--glass-surface-shadow);
}

.scb-button--glassmorphic-primary:hover .scb-circle {
  background: color-mix(in srgb, var(--color-Primary-600) 35%, var(--glass-card-bg));
  color: var(--color-Primary-900);
  backdrop-filter: blur(var(--glass-card-blur));
  -webkit-backdrop-filter: blur(var(--glass-card-blur));
  border: 1px solid color-mix(in srgb, var(--color-Primary-500) 40%, transparent);
}

.scb-button--glassmorphic-secondary .scb-circle {
  background: color-mix(in srgb, var(--color-Secondary-500) 25%, var(--glass-surface-bg));
  color: var(--color-Secondary-800);
  backdrop-filter: blur(var(--glass-surface-blur));
  -webkit-backdrop-filter: blur(var(--glass-surface-blur));
  border: 1px solid color-mix(in srgb, var(--color-Secondary-400) 30%, transparent);
  box-shadow:
    inset 2px 2px 4px color-mix(in srgb, var(--color-Secondary-700) 15%, transparent),
    inset -2px -2px 4px color-mix(in srgb, var(--color-Secondary-100) 20%, transparent),
    var(--glass-surface-shadow);
}

.scb-button--glassmorphic-secondary:hover .scb-circle {
  background: color-mix(in srgb, var(--color-Secondary-600) 35%, var(--glass-card-bg));
  color: var(--color-Secondary-900);
  backdrop-filter: blur(var(--glass-card-blur));
  -webkit-backdrop-filter: blur(var(--glass-card-blur));
  border: 1px solid color-mix(in srgb, var(--color-Secondary-500) 40%, transparent);
}

.scb-button--glassmorphic-accent1 .scb-circle {
  background: color-mix(in srgb, var(--color-AccentOne-500) 25%, var(--glass-surface-bg));
  color: var(--color-AccentOne-800);
  backdrop-filter: blur(var(--glass-surface-blur));
  -webkit-backdrop-filter: blur(var(--glass-surface-blur));
  border: 1px solid color-mix(in srgb, var(--color-AccentOne-400) 30%, transparent);
  box-shadow:
    inset 2px 2px 4px color-mix(in srgb, var(--color-AccentOne-700) 15%, transparent),
    inset -2px -2px 4px color-mix(in srgb, var(--color-AccentOne-100) 20%, transparent),
    var(--glass-surface-shadow);
}

.scb-button--glassmorphic-accent1:hover .scb-circle {
  background: color-mix(in srgb, var(--color-AccentOne-600) 35%, var(--glass-card-bg));
  color: var(--color-AccentOne-900);
  backdrop-filter: blur(var(--glass-card-blur));
  -webkit-backdrop-filter: blur(var(--glass-card-blur));
  border: 1px solid color-mix(in srgb, var(--color-AccentOne-500) 40%, transparent);
}

.scb-button--glassmorphic-accent2 .scb-circle {
  background: color-mix(in srgb, var(--color-AccentTwo-500) 25%, var(--glass-surface-bg));
  color: var(--color-AccentTwo-800);
  backdrop-filter: blur(var(--glass-surface-blur));
  -webkit-backdrop-filter: blur(var(--glass-surface-blur));
  border: 1px solid color-mix(in srgb, var(--color-AccentTwo-400) 30%, transparent);
  box-shadow:
    inset 2px 2px 4px color-mix(in srgb, var(--color-AccentTwo-700) 15%, transparent),
    inset -2px -2px 4px color-mix(in srgb, var(--color-AccentTwo-100) 20%, transparent),
    var(--glass-surface-shadow);
}

.scb-button--glassmorphic-accent2:hover .scb-circle {
  background: color-mix(in srgb, var(--color-AccentTwo-600) 35%, var(--glass-card-bg));
  color: var(--color-AccentTwo-900);
  backdrop-filter: blur(var(--glass-card-blur));
  -webkit-backdrop-filter: blur(var(--glass-card-blur));
  border: 1px solid color-mix(in srgb, var(--color-AccentTwo-500) 40%, transparent);
}

.scb-button--glassmorphic-accent3 .scb-circle {
  background: color-mix(in srgb, var(--color-AccentThree-500) 25%, var(--glass-surface-bg));
  color: var(--color-AccentThree-800);
  backdrop-filter: blur(var(--glass-surface-blur));
  -webkit-backdrop-filter: blur(var(--glass-surface-blur));
  border: 1px solid color-mix(in srgb, var(--color-AccentThree-400) 30%, transparent);
  box-shadow:
    inset 2px 2px 4px color-mix(in srgb, var(--color-AccentThree-700) 15%, transparent),
    inset -2px -2px 4px color-mix(in srgb, var(--color-AccentThree-100) 20%, transparent),
    var(--glass-surface-shadow);
}

.scb-button--glassmorphic-accent3:hover .scb-circle {
  background: color-mix(in srgb, var(--color-AccentThree-600) 35%, var(--glass-card-bg));
  color: var(--color-AccentThree-900);
  backdrop-filter: blur(var(--glass-card-blur));
  -webkit-backdrop-filter: blur(var(--glass-card-blur));
  border: 1px solid color-mix(in srgb, var(--color-AccentThree-500) 40%, transparent);
}

.scb-button--glassmorphic-accent4 .scb-circle {
  background: color-mix(in srgb, var(--color-AccentFour-500) 25%, var(--glass-surface-bg));
  color: var(--color-AccentFour-800);
  backdrop-filter: blur(var(--glass-surface-blur));
  -webkit-backdrop-filter: blur(var(--glass-surface-blur));
  border: 1px solid color-mix(in srgb, var(--color-AccentFour-400) 30%, transparent);
  box-shadow:
    inset 2px 2px 4px color-mix(in srgb, var(--color-AccentFour-700) 15%, transparent),
    inset -2px -2px 4px color-mix(in srgb, var(--color-AccentFour-100) 20%, transparent),
    var(--glass-surface-shadow);
}

.scb-button--glassmorphic-accent4:hover .scb-circle {
  background: color-mix(in srgb, var(--color-AccentFour-600) 35%, var(--glass-card-bg));
  color: var(--color-AccentFour-900);
  backdrop-filter: blur(var(--glass-card-blur));
  -webkit-backdrop-filter: blur(var(--glass-card-blur));
  border: 1px solid color-mix(in srgb, var(--color-AccentFour-500) 40%, transparent);
}

.scb-button--glassmorphic-accent5 .scb-circle {
  background: color-mix(in srgb, var(--color-AccentFive-500) 25%, var(--glass-surface-bg));
  color: var(--color-AccentFive-800);
  backdrop-filter: blur(var(--glass-surface-blur));
  -webkit-backdrop-filter: blur(var(--glass-surface-blur));
  border: 1px solid color-mix(in srgb, var(--color-AccentFive-400) 30%, transparent);
  box-shadow:
    inset 2px 2px 4px color-mix(in srgb, var(--color-AccentFive-700) 15%, transparent),
    inset -2px -2px 4px color-mix(in srgb, var(--color-AccentFive-100) 20%, transparent),
    var(--glass-surface-shadow);
}

.scb-button--glassmorphic-accent5:hover .scb-circle {
  background: color-mix(in srgb, var(--color-AccentFive-600) 35%, var(--glass-card-bg));
  color: var(--color-AccentFive-900);
  backdrop-filter: blur(var(--glass-card-blur));
  -webkit-backdrop-filter: blur(var(--glass-card-blur));
  border: 1px solid color-mix(in srgb, var(--color-AccentFive-500) 40%, transparent);
}

/* Neumorphic variants - soft 3D pushed-in effect */
.scb-button--neumorphic-primary .scb-circle {
  background: var(--color-Primary-600);
  box-shadow:
    inset 3px 3px 6px rgba(0, 0, 0, 0.2),
    inset -3px -3px 6px rgba(255, 255, 255, 0.1);
}

.scb-button--neumorphic-secondary .scb-circle {
  background: var(--color-Secondary-600);
  box-shadow:
    inset 3px 3px 6px rgba(0, 0, 0, 0.2),
    inset -3px -3px 6px rgba(255, 255, 255, 0.1);
}

.scb-button--neumorphic-accent1 .scb-circle {
  background: var(--color-AccentOne-600);
  box-shadow:
    inset 3px 3px 6px rgba(0, 0, 0, 0.2),
    inset -3px -3px 6px rgba(255, 255, 255, 0.1);
}

.scb-button--neumorphic-accent2 .scb-circle {
  background: var(--color-AccentTwo-600);
  box-shadow:
    inset 3px 3px 6px rgba(0, 0, 0, 0.2),
    inset -3px -3px 6px rgba(255, 255, 255, 0.1);
}

.scb-button--neumorphic-accent3 .scb-circle {
  background: var(--color-AccentThree-600);
  box-shadow:
    inset 3px 3px 6px rgba(0, 0, 0, 0.2),
    inset -3px -3px 6px rgba(255, 255, 255, 0.1);
}

.scb-button--neumorphic-accent4 .scb-circle {
  background: var(--color-AccentFour-600);
  box-shadow:
    inset 3px 3px 6px rgba(0, 0, 0, 0.2),
    inset -3px -3px 6px rgba(255, 255, 255, 0.1);
}

.scb-button--neumorphic-accent5 .scb-circle {
  background: var(--color-AccentFive-600);
  box-shadow:
    inset 3px 3px 6px rgba(0, 0, 0, 0.2),
    inset -3px -3px 6px rgba(255, 255, 255, 0.1);
}

/* Gradient variants - solid background, animated gradient on hover */
@keyframes gradientFlow {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

.scb-button--gradient-primary .scb-circle {
  background: var(--color-Primary-600);
  transition: background 0.3s ease;
}

.scb-button--gradient-secondary .scb-circle {
  background: var(--color-Secondary-600);
  transition: background 0.3s ease;
}

.scb-button--gradient-accent1 .scb-circle {
  background: var(--color-AccentOne-600);
  transition: background 0.3s ease;
}

.scb-button--gradient-accent2 .scb-circle {
  background: var(--color-AccentTwo-600);
  transition: background 0.3s ease;
}

.scb-button--gradient-accent3 .scb-circle {
  background: var(--color-AccentThree-600);
  transition: background 0.3s ease;
}

.scb-button--gradient-accent4 .scb-circle {
  background: var(--color-AccentFour-600);
  transition: background 0.3s ease;
}

.scb-button--gradient-accent5 .scb-circle {
  background: var(--color-AccentFive-600);
  transition: background 0.3s ease;
}

/* Hover: Animated gradient */
.scb-button--gradient-primary:hover .scb-circle {
  background: var(--gradient-primary-glow);
  background-size: 300% 300%;
  animation: gradientFlow 3s ease infinite;
}

.scb-button--gradient-secondary:hover .scb-circle {
  background: var(--gradient-secondary-glow);
  background-size: 300% 300%;
  animation: gradientFlow 3s ease infinite;
}

.scb-button--gradient-accent1:hover .scb-circle {
  background: var(--gradient-accent1-glow);
  background-size: 300% 300%;
  animation: gradientFlow 3s ease infinite;
}

.scb-button--gradient-accent2:hover .scb-circle {
  background: var(--gradient-accent2-glow);
  background-size: 300% 300%;
  animation: gradientFlow 3s ease infinite;
}

.scb-button--gradient-accent3:hover .scb-circle {
  background: var(--gradient-accent3-glow);
  background-size: 300% 300%;
  animation: gradientFlow 3s ease infinite;
}

.scb-button--gradient-accent4:hover .scb-circle {
  background: var(--gradient-accent4-glow);
  background-size: 300% 300%;
  animation: gradientFlow 3s ease infinite;
}

.scb-button--gradient-accent5:hover .scb-circle {
  background: var(--gradient-accent5-glow);
  background-size: 300% 300%;
  animation: gradientFlow 3s ease infinite;
}

/* Glow variants - BaseButton glow style with gradient background and blur glow */
@keyframes glowloop {
  0%   { background-position: 0% 50%; }
  50%  { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* Primary Glow */
.scb-button--glow-primary .scb-circle {
  background-color: var(--color-Primary-500);
  color: white;
}

.scb-button--glow-primary:hover .scb-circle {
  background: var(--gradient-primary-glow);
  background-size: 200% 200%;
  animation: glowloop 4s linear infinite;
  color: white;
}

.scb-button--glow-primary .scb-circle::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: var(--gradient-primary-glow);
  background-size: 200% 200%;
  opacity: 0;
  filter: blur(0px) saturate(1) contrast(1);
  z-index: -2;
  transition: opacity .5s ease, filter .5s ease;
  animation: glowloop 2s linear infinite;
  pointer-events: none;
  will-change: opacity, filter;
}

.scb-button--glow-primary:hover .scb-circle::after {
  opacity: 1;
  filter: blur(clamp(16px, 3vw, 40px)) saturate(1.6) contrast(1.5);
}

/* Secondary Glow */
.scb-button--glow-secondary .scb-circle {
  background-color: var(--color-Secondary-500);
  color: white;
}

.scb-button--glow-secondary:hover .scb-circle {
  background: var(--gradient-secondary-glow);
  background-size: 200% 200%;
  animation: glowloop 4s linear infinite;
  color: white;
}

.scb-button--glow-secondary .scb-circle::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: var(--gradient-secondary-glow);
  background-size: 200% 200%;
  opacity: 0;
  filter: blur(0px) saturate(1) contrast(1);
  z-index: -2;
  transition: opacity .5s ease, filter .5s ease;
  animation: glowloop 2s linear infinite;
  pointer-events: none;
  will-change: opacity, filter;
}

.scb-button--glow-secondary:hover .scb-circle::after {
  opacity: 1;
  filter: blur(clamp(16px, 3vw, 40px)) saturate(1.6) contrast(1.5);
}

/* Accent1 Glow */
.scb-button--glow-accent1 .scb-circle {
  background-color: var(--color-AccentOne-500);
  color: white;
}

.scb-button--glow-accent1:hover .scb-circle {
  background: var(--gradient-accent1-glow);
  background-size: 200% 200%;
  animation: glowloop 4s linear infinite;
  color: white;
}

.scb-button--glow-accent1 .scb-circle::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: var(--gradient-accent1-glow);
  background-size: 200% 200%;
  opacity: 0;
  filter: blur(0px) saturate(1) contrast(1);
  z-index: -2;
  transition: opacity .5s ease, filter .5s ease;
  animation: glowloop 2s linear infinite;
  pointer-events: none;
  will-change: opacity, filter;
}

.scb-button--glow-accent1:hover .scb-circle::after {
  opacity: 1;
  filter: blur(clamp(16px, 3vw, 40px)) saturate(1.6) contrast(1.5);
}

/* Accent2 Glow */
.scb-button--glow-accent2 .scb-circle {
  background-color: var(--color-AccentTwo-500);
  color: white;
}

.scb-button--glow-accent2:hover .scb-circle {
  background: var(--gradient-accent2-glow);
  background-size: 200% 200%;
  animation: glowloop 4s linear infinite;
  color: white;
}

.scb-button--glow-accent2 .scb-circle::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: var(--gradient-accent2-glow);
  background-size: 200% 200%;
  opacity: 0;
  filter: blur(0px) saturate(1) contrast(1);
  z-index: -2;
  transition: opacity .5s ease, filter .5s ease;
  animation: glowloop 2s linear infinite;
  pointer-events: none;
  will-change: opacity, filter;
}

.scb-button--glow-accent2:hover .scb-circle::after {
  opacity: 1;
  filter: blur(clamp(16px, 3vw, 40px)) saturate(1.6) contrast(1.5);
}

/* Accent3 Glow */
.scb-button--glow-accent3 .scb-circle {
  background-color: var(--color-AccentThree-500);
  color: white;
}

.scb-button--glow-accent3:hover .scb-circle {
  background: var(--gradient-accent3-glow);
  background-size: 200% 200%;
  animation: glowloop 4s linear infinite;
  color: white;
}

.scb-button--glow-accent3 .scb-circle::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: var(--gradient-accent3-glow);
  background-size: 200% 200%;
  opacity: 0;
  filter: blur(0px) saturate(1) contrast(1);
  z-index: -2;
  transition: opacity .5s ease, filter .5s ease;
  animation: glowloop 2s linear infinite;
  pointer-events: none;
  will-change: opacity, filter;
}

.scb-button--glow-accent3:hover .scb-circle::after {
  opacity: 1;
  filter: blur(clamp(16px, 3vw, 40px)) saturate(1.6) contrast(1.5);
}

/* Accent4 Glow */
.scb-button--glow-accent4 .scb-circle {
  background-color: var(--color-AccentFour-500);
  color: white;
}

.scb-button--glow-accent4:hover .scb-circle {
  background: var(--gradient-accent4-glow);
  background-size: 200% 200%;
  animation: glowloop 4s linear infinite;
  color: white;
}

.scb-button--glow-accent4 .scb-circle::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: var(--gradient-accent4-glow);
  background-size: 200% 200%;
  opacity: 0;
  filter: blur(0px) saturate(1) contrast(1);
  z-index: -2;
  transition: opacity .5s ease, filter .5s ease;
  animation: glowloop 2s linear infinite;
  pointer-events: none;
  will-change: opacity, filter;
}

.scb-button--glow-accent4:hover .scb-circle::after {
  opacity: 1;
  filter: blur(clamp(16px, 3vw, 40px)) saturate(1.6) contrast(1.5);
}

/* Accent5 Glow */
.scb-button--glow-accent5 .scb-circle {
  background-color: var(--color-AccentFive-500);
  color: white;
}

.scb-button--glow-accent5:hover .scb-circle {
  background: var(--gradient-accent5-glow);
  background-size: 200% 200%;
  animation: glowloop 4s linear infinite;
  color: white;
}

.scb-button--glow-accent5 .scb-circle::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: var(--gradient-accent5-glow);
  background-size: 200% 200%;
  opacity: 0;
  filter: blur(0px) saturate(1) contrast(1);
  z-index: -2;
  transition: opacity .5s ease, filter .5s ease;
  animation: glowloop 2s linear infinite;
  pointer-events: none;
  will-change: opacity, filter;
}

.scb-button--glow-accent5:hover .scb-circle::after {
  opacity: 1;
  filter: blur(clamp(16px, 3vw, 40px)) saturate(1.6) contrast(1.5);
}

/* Set visible text color for each variant */
.scb-button--primary   .scb-button-text { color: var(--color-Primary-600); }
.scb-button--secondary .scb-button-text { color: var(--color-Secondary-600); }
.scb-button--slide-primary   .scb-button-text { color: var(--color-Primary-600); }
.scb-button--slide-secondary .scb-button-text { color: var(--color-Secondary-600); }
.scb-button--slide-accent1   .scb-button-text { color: var(--color-AccentOne-600); }
.scb-button--chachaslide-primary   .scb-button-text { color: var(--color-Primary-600); }
.scb-button--chachaslide-secondary .scb-button-text { color: var(--color-Secondary-600); }
.scb-button--chachaslide-accent1   .scb-button-text { color: var(--color-AccentOne-600); }
.scb-button--glassmorphic-primary   .scb-button-text { color: var(--color-Primary-600); }
.scb-button--glassmorphic-secondary .scb-button-text { color: var(--color-Secondary-600); }
.scb-button--glassmorphic-accent1   .scb-button-text { color: var(--color-AccentOne-600); }
.scb-button--neumorphic-primary   .scb-button-text { color: var(--color-Primary-600); }
.scb-button--neumorphic-secondary .scb-button-text { color: var(--color-Secondary-600); }
.scb-button--neumorphic-accent1   .scb-button-text { color: var(--color-AccentOne-600); }
.scb-button--gradient-primary   .scb-button-text { color: var(--color-Primary-600); }
.scb-button--gradient-secondary .scb-button-text { color: var(--color-Secondary-600); }
.scb-button--gradient-accent1   .scb-button-text { color: var(--color-AccentOne-600); }
.scb-button--glow-primary   .scb-button-text { color: var(--color-Primary-600); }
.scb-button--glow-secondary .scb-button-text { color: var(--color-Secondary-600); }
.scb-button--glow-accent1   .scb-button-text { color: var(--color-AccentOne-600); }

/* If your design needs a different icon colour per theme, tune here */
.scb-button--primary   .scb-icon,
.scb-button--secondary .scb-icon,
.scb-button--accent1   .scb-icon,
.scb-button--accent2   .scb-icon,
.scb-button--accent3   .scb-icon,
.scb-button--accent4   .scb-icon,
.scb-button--accent5   .scb-icon,
.scb-button--slide-primary   .scb-icon,
.scb-button--slide-secondary .scb-icon,
.scb-button--slide-accent1   .scb-icon,
.scb-button--slide-accent2   .scb-icon,
.scb-button--slide-accent3   .scb-icon,
.scb-button--slide-accent4   .scb-icon,
.scb-button--slide-accent5   .scb-icon,
.scb-button--chachaslide-primary   .scb-svg-icon,
.scb-button--chachaslide-secondary .scb-svg-icon,
.scb-button--chachaslide-accent1   .scb-svg-icon,
.scb-button--chachaslide-accent2   .scb-svg-icon,
.scb-button--chachaslide-accent3   .scb-svg-icon,
.scb-button--chachaslide-accent4   .scb-svg-icon,
.scb-button--chachaslide-accent5   .scb-svg-icon,
.scb-button--glassmorphic-primary   .scb-svg-icon,
.scb-button--glassmorphic-secondary .scb-svg-icon,
.scb-button--glassmorphic-accent1   .scb-svg-icon,
.scb-button--glassmorphic-accent2   .scb-svg-icon,
.scb-button--glassmorphic-accent3   .scb-svg-icon,
.scb-button--glassmorphic-accent4   .scb-svg-icon,
.scb-button--glassmorphic-accent5   .scb-svg-icon,
.scb-button--neumorphic-primary   .scb-svg-icon,
.scb-button--neumorphic-secondary .scb-svg-icon,
.scb-button--neumorphic-accent1   .scb-svg-icon,
.scb-button--neumorphic-accent2   .scb-svg-icon,
.scb-button--neumorphic-accent3   .scb-svg-icon,
.scb-button--neumorphic-accent4   .scb-svg-icon,
.scb-button--neumorphic-accent5   .scb-svg-icon,
.scb-button--gradient-primary   .scb-svg-icon,
.scb-button--gradient-secondary .scb-svg-icon,
.scb-button--gradient-accent1   .scb-svg-icon,
.scb-button--gradient-accent2   .scb-svg-icon,
.scb-button--gradient-accent3   .scb-svg-icon,
.scb-button--gradient-accent4   .scb-svg-icon,
.scb-button--gradient-accent5   .scb-svg-icon,
.scb-button--glow-primary   .scb-svg-icon,
.scb-button--glow-secondary .scb-svg-icon,
.scb-button--glow-accent1   .scb-svg-icon,
.scb-button--glow-accent2   .scb-svg-icon,
.scb-button--glow-accent3   .scb-svg-icon,
.scb-button--glow-accent4   .scb-svg-icon,
.scb-button--glow-accent5   .scb-svg-icon { color: var(--color-Background-50, #fff); }

/* Hover effects - icon transitions to arrow */
.scb-button:hover .scb-circle { width: 100%; }

/* CSS plus icon fades out and rotates on hover */
.scb-button:hover .scb-plus { transform: translate(-50%, -50%) rotate(45deg); opacity: 0; }

/* Remove the old fade-out styles - animated icons now stay visible */

/* Arrow appears on hover */
.scb-button:hover .scb-arrow  { opacity: 1; }
.scb-button--primary:hover   .scb-button-text,
.scb-button--secondary:hover .scb-button-text,
.scb-button--accent1:hover   .scb-button-text,
.scb-button--accent2:hover   .scb-button-text,
.scb-button--accent3:hover   .scb-button-text,
.scb-button--accent4:hover   .scb-button-text,
.scb-button--accent5:hover   .scb-button-text,
.scb-button--slide-primary:hover   .scb-button-text,
.scb-button--slide-secondary:hover .scb-button-text,
.scb-button--slide-accent1:hover   .scb-button-text,
.scb-button--slide-accent2:hover   .scb-button-text,
.scb-button--slide-accent3:hover   .scb-button-text,
.scb-button--slide-accent4:hover   .scb-button-text,
.scb-button--slide-accent5:hover   .scb-button-text,
.scb-button--chachaslide-primary:hover   .scb-button-text,
.scb-button--chachaslide-secondary:hover .scb-button-text,
.scb-button--chachaslide-accent1:hover   .scb-button-text,
.scb-button--chachaslide-accent2:hover   .scb-button-text,
.scb-button--chachaslide-accent3:hover   .scb-button-text,
.scb-button--chachaslide-accent4:hover   .scb-button-text,
.scb-button--chachaslide-accent5:hover   .scb-button-text,
.scb-button--glassmorphic-primary:hover   .scb-button-text,
.scb-button--glassmorphic-secondary:hover .scb-button-text,
.scb-button--glassmorphic-accent1:hover   .scb-button-text,
.scb-button--glassmorphic-accent2:hover   .scb-button-text,
.scb-button--glassmorphic-accent3:hover   .scb-button-text,
.scb-button--glassmorphic-accent4:hover   .scb-button-text,
.scb-button--glassmorphic-accent5:hover   .scb-button-text,
.scb-button--neumorphic-primary:hover   .scb-button-text,
.scb-button--neumorphic-secondary:hover .scb-button-text,
.scb-button--neumorphic-accent1:hover   .scb-button-text,
.scb-button--neumorphic-accent2:hover   .scb-button-text,
.scb-button--neumorphic-accent3:hover   .scb-button-text,
.scb-button--neumorphic-accent4:hover   .scb-button-text,
.scb-button--neumorphic-accent5:hover   .scb-button-text,
.scb-button--gradient-primary:hover   .scb-button-text,
.scb-button--gradient-secondary:hover .scb-button-text,
.scb-button--gradient-accent1:hover   .scb-button-text,
.scb-button--gradient-accent2:hover   .scb-button-text,
.scb-button--gradient-accent3:hover   .scb-button-text,
.scb-button--gradient-accent4:hover   .scb-button-text,
.scb-button--gradient-accent5:hover   .scb-button-text,
.scb-button--glow-primary:hover   .scb-button-text,
.scb-button--glow-secondary:hover .scb-button-text,
.scb-button--glow-accent1:hover   .scb-button-text,
.scb-button--glow-accent2:hover   .scb-button-text,
.scb-button--glow-accent3:hover   .scb-button-text,
.scb-button--glow-accent4:hover   .scb-button-text,
.scb-button--glow-accent5:hover   .scb-button-text { color: var(--color-Background-50, #fff); }

/* Responsive */
@media (max-width: 768px) {
  :root { --scb-circle-size: 2.2rem; --scb-icon-size: .9rem; }
  .scb-button { padding: 1.5rem 1.5rem 1.5rem 3.5rem; }
  .scb-button-text { font-size: var(--font-size-sm); }

  /* Adjust Lottie icon size for mobile */
  .scb-lottie {
    width: calc(var(--scb-icon-size) * 1.8);
    height: calc(var(--scb-icon-size) * 1.8);
  }

  /* Adjust neumorphic shadows for smaller screens */
  .scb-button--neumorphic {
    box-shadow:
      4px 4px 8px var(--color-black-t-15),
      -4px -4px 8px var(--color-white-t-50);
  }

  .scb-button--neumorphic:hover {
    box-shadow:
      5px 5px 10px var(--color-black-t-20),
      -5px -5px 10px var(--color-white-t-60);
  }

  /* Adjust glassmorphic blur for performance on mobile */
  .scb-button--glassmorphic {
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
  }

  .scb-button--glassmorphic:hover {
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
  }
}



/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .scb-circle, .scb-icon, .scb-button-text { transition: none !important; }
}

</style>

<script>
  // SVG Path Animation handler for ChaChaSlide variants
  class ChaChaSlideAnimation {
    constructor() {
      this.initializeSVGPaths();
    }

    initializeSVGPaths() {
      const svgIcons = document.querySelectorAll('.scb-svg-icon');
      const LENGTH_THRESHOLD = 20; // Paths shorter than this are considered "dots" or small elements

      svgIcons.forEach(container => {
        const button = container.closest('.scb-button');
        const paths = container.querySelectorAll('path, circle, rect, line, polyline, polygon');

        // Get button variant to determine token color
        const variantClass = button?.className.match(/scb-button--(chachaslide-[\w-]+|glassmorphic-[\w-]+|neumorphic-[\w-]+|gradient-[\w-]+|glow-[\w-]+)/)?.[1];
        let tokenColor = '#000';

        if (variantClass?.includes('primary')) {
          tokenColor = getComputedStyle(button).getPropertyValue('--color-Primary-600') || '#000';
        } else if (variantClass?.includes('secondary')) {
          tokenColor = getComputedStyle(button).getPropertyValue('--color-Secondary-600') || '#000';
        } else if (variantClass?.includes('accent1')) {
          tokenColor = getComputedStyle(button).getPropertyValue('--color-AccentOne-600') || '#000';
        } else if (variantClass?.includes('accent2')) {
          tokenColor = getComputedStyle(button).getPropertyValue('--color-AccentTwo-600') || '#000';
        } else if (variantClass?.includes('accent3')) {
          tokenColor = getComputedStyle(button).getPropertyValue('--color-AccentThree-600') || '#000';
        }

        paths.forEach(path => {
          const length = path.getTotalLength ? path.getTotalLength() : 100;
          const isSmallElement = length < LENGTH_THRESHOLD;

          // Setup: all paths visible with white stroke, fully drawn
          path.style.strokeDasharray = length;
          path.style.strokeDashoffset = '0'; // Starts fully drawn

          const duration = Math.min(800, Math.max(400, length * 1.5));

          path.style.transition = `stroke-dashoffset ${duration}ms ease-in, stroke-width 0.3s`;

          if (isSmallElement) {
            path.style.transition += ', opacity 0.2s ease-in 0.4s';
          }
        });

        if (button) {
          button.addEventListener('mouseenter', () => {
            paths.forEach((path, index) => {
              setTimeout(() => {
                const length = path.getTotalLength ? path.getTotalLength() : 100;
                const isSmallElement = length < LENGTH_THRESHOLD;
                const duration = Math.min(800, Math.max(400, length * 1.5));

                // Two-phase animation (token color â†’ white)
                // First phase: Animate from 0 to length in token color (undraw/erase effect)
                path.style.stroke = tokenColor;
                path.style.strokeWidth = '2';

                requestAnimationFrame(() => {
                  path.style.strokeDashoffset = String(length); // Animate to length (erases the line)

                  // Second phase: After erasing, redraw in white
                  setTimeout(() => {
                    path.style.stroke = '#fff';
                    path.style.strokeDashoffset = String(length); // Start from erased state

                    requestAnimationFrame(() => {
                      path.style.strokeDashoffset = '0'; // Animate back to 0 (draws the line)
                    });
                  }, isSmallElement ? duration + 400 : duration);
                });
              }, index * 250); // 250ms stagger delay
            });
          });

          button.addEventListener('mouseleave', () => {
            paths.forEach(path => {
              // Reset to white stroke and fully drawn
              path.style.stroke = '#fff';
              path.style.strokeDashoffset = '0';
            });
          });
        }
      });
    }
  }

  // Lottie animation handler for SlideColourButton
  class SlideColourButtonLottie {
    constructor() {
      this.animations = new Map();
      this.init();
    }

    async init() {
      // Check if Lottie is available (will be loaded by CDN)
      if (typeof window !== 'undefined') {
        await this.loadLottie();
        this.initializeAnimations();
      }
    }

    async loadLottie() {
      // Load Lottie if not already loaded
      if (!window.lottie) {
        return new Promise((resolve) => {
          const script = document.createElement('script');
          script.src = 'https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js';
          script.onload = resolve;
          document.head.appendChild(script);
        });
      }
    }

    initializeAnimations() {
      const lottieContainers = document.querySelectorAll('.scb-lottie');

      lottieContainers.forEach(container => {
        const animationType = container.dataset.animation;
        let animationData;

        // Map animation types to their JSON files
        switch (animationType) {
          case 'animated-plus':
            animationData = '/Animated Icons/Plus to X/plusToX.json';
            break;
          case 'animated-star':
            animationData = '/Animated Icons/Star/star.json';
            break;
          case 'animated-chevron':
            animationData = '/Animated Icons/Chevron-right/chevron-right.json';
            break;
          default:
            return;
        }

        // Load and create Lottie animation
        const animation = window.lottie.loadAnimation({
          container: container,
          renderer: 'svg',
          loop: false,
          autoplay: false,
          path: animationData,
          rendererSettings: {
            className: 'scb-lottie-svg' // Add class for precise CSS targeting
          }
        });

        this.animations.set(container, animation);

        // Initialize as static (first frame) and force white colors
        animation.addEventListener('DOMLoaded', () => {
          animation.goToAndStop(0, true);

          // Force white colors on all SVG elements after DOM is loaded
          setTimeout(() => {
            const svgElements = container.querySelectorAll('svg *');
            svgElements.forEach(el => {
              if (el.getAttribute('fill') && el.getAttribute('fill') !== 'none') {
                el.style.fill = 'white';
                el.setAttribute('fill', 'white');
              }
              if (el.getAttribute('stroke') && el.getAttribute('stroke') !== 'none') {
                el.style.stroke = 'white';
                el.setAttribute('stroke', 'white');
                el.style.strokeWidth = '3';
                el.setAttribute('stroke-width', '3');
              }
            });
          }, 100);
        });

        // Set up hover animations for parent button
        const button = container.closest('.scb-button');
        if (button) {
          button.addEventListener('mouseenter', () => {
            // Play animation from start when hovering
            animation.goToAndPlay(0, true);
          });

          button.addEventListener('mouseleave', () => {
            // Return to static first frame when not hovering
            setTimeout(() => {
              animation.goToAndStop(0, true);
            }, 300); // Small delay to let circle animation finish
          });
        }
      });
    }
  }

  // Initialize when DOM is ready
  if (typeof window !== 'undefined') {
    document.addEventListener('DOMContentLoaded', () => {
      new ChaChaSlideAnimation();
      new SlideColourButtonLottie();
    });
  }
</script>
