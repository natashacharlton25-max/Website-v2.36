---
/** OutlineButton.astro (Token-Mapped)
 * Self-contained outline button with pressed state on hover/active.
 */
// Import design system tokens
// import '../../styles/DropShadows.css'; // File doesn't exist
import '../../styles/Glassmorphic.css';
import '../../styles/ButtonSizes.css';
import './ThemedDropdown.astro';

export interface Props {
  label?: string;
  href?: string;
  target?: string;
  variant?: 'primary' | 'secondary' | 'accent1' | 'accent2' | 'accent3' | 'accent4' | 'accent5' | 'accent' | 'glow' | 'glass' | 'neumorphic' | 'gradient' | 'accent-filled' | 'ghost';
  disabled?: boolean;
  shape?: 'default' | 'round' | 'square';
  radius?: 'sharp' | 'default' | 'soft' | 'pill';
  size?: 'sm' | 'md' | 'lg';
  animatedIcon?: string;
  isDropdown?: boolean;
  dropdownItems?: Array<{label: string, href?: string}>;
  className?: string;
}

const {
  label = 'Click Me',
  href = 'https://example.com',
  target = '_blank',
  variant = 'primary',
  disabled = false,
  shape = 'default',
  radius = 'default',
  size = 'md',
  animatedIcon,
  isDropdown = false,
  dropdownItems = [
    {label: 'Option 1', href: '#'},
    {label: 'Option 2', href: '#'},
    {label: 'Option 3', href: '#'}
  ],
  className = ''
} = Astro.props;

const showIcon = (shape === 'round' || shape === 'square') && animatedIcon;
const iconPath = showIcon ? `/Animated Icons/${animatedIcon}` : '';

// Map variant to color theme for ThemedDropdown
const colorTheme = variant === 'accent' ? 'accent5' :
                   variant === 'gradient' || variant === 'glass' || variant === 'neumorphic' || variant === 'glow' || variant === 'accent-filled' ? 'primary' :
                   variant as 'primary' | 'secondary' | 'accent1' | 'accent2' | 'accent3' | 'accent4' | 'accent5';
---

<div class="opb-container">
  {isDropdown ? (
    <div class="dropdown-wrapper">
      <button
        class={`opb-button opb-button--${variant} opb-button--${shape} opb-button--radius-${radius} opb-button--${size} opb-dropdown dropdown-btn ${disabled ? 'opb-button--disabled' : ''} ${className}`}
        disabled={disabled}
        style={disabled ? 'cursor: not-allowed;' : undefined}
      >
        {showIcon ? (
          <div class="opb-icon">
            {animatedIcon === 'Star/star.svg' && (
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
              </svg>
            )}
            {animatedIcon === 'Plus to X/plus.svg' && (
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
            )}
            {animatedIcon === 'Plus to X/x.svg' && (
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
            )}
          </div>
        ) : (
          label
        )}
        <svg class="dropdown-chevron" viewBox="0 0 24 24" fill="currentColor">
          <path d="M7 10l5 5 5-5z"/>
        </svg>
      </button>
      <ThemedDropdown
        colorTheme={colorTheme}
        dropdownItems={dropdownItems}
        borderStyle="2px solid"
        colorShade="500"
        hoverColorShade="500"
      />
    </div>
  ) : (
    <a
      class={`opb-button opb-button--${variant} opb-button--${shape} opb-button--radius-${radius} opb-button--${size} ${disabled ? 'opb-button--disabled' : ''} ${className}`}
      href={disabled ? undefined : href}
      target={disabled ? undefined : target}
      rel={disabled ? undefined : "noopener noreferrer"}
      aria-disabled={disabled}
      style={disabled ? 'cursor: not-allowed;' : undefined}
    >
      {showIcon ? (
        <div class="opb-icon">
          {animatedIcon === 'Star/star.svg' && (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
            </svg>
          )}
          {animatedIcon === 'Plus to X/plus.svg' && (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
          )}
          {animatedIcon === 'Plus to X/x.svg' && (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          )}
        </div>
      ) : (
        label
      )}
    </a>
  )}
</div>

<style is:global>
  .opb-container {
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
  }

  .opb-button {
    display: flex;
    align-items: center;
    justify-content: center;
    outline: none;
    cursor: pointer;
    width: auto;
    min-width: fit-content;
    min-height: var(--btn-size-default-min-height);
    padding: var(--btn-size-default-padding);
    margin: 0.75rem 0.75rem 0.75rem 0;
    text-decoration: none !important;
    border-radius: var(--radius-md);
    border-width: 2px;
    border-style: solid;
    box-sizing: border-box;
    transition: all var(--transition-fast);
    font-family: var(--font-body);
    font-size: var(--btn-size-default-font-size);
    font-weight: var(--font-weight-medium);
    text-transform: uppercase;
    letter-spacing: 0.075em;
    text-shadow: none;
    box-shadow: none;
    text-align: center;
    white-space: normal;
    word-wrap: break-word;
  }

  .opb-button:hover,
  .opb-button:active,
  .opb-button:focus {
    text-decoration: none !important;
  }

  /* Primary variant */
  .opb-button--primary {
    background: transparent;
    border-color: var(--color-Primary-500);
    color: var(--color-Primary-500);
    --btn-gradient: var(--gradient-primary);
    --btn-color-500: var(--color-Primary-500);
  }

  .opb-button--primary:hover {
    background: var(--color-Primary-500) !important;
    box-shadow: 0 4px 12px color-mix(in oklch, var(--color-Primary-500), transparent 70%);
    border-color: transparent !important;
    color: var(--color-Background-50) !important;
  }

  .opb-button--primary:active,
  .opb-button--primary:focus {
    box-shadow: 0 2px 8px color-mix(in oklch, var(--color-Primary-500), transparent 78%) inset;
    border-color: var(--color-Primary-700);
    outline: none;
  }

  /* Secondary variant */
  .opb-button--secondary {
    background: transparent;
    border-color: var(--color-Secondary-500);
    color: var(--color-Secondary-500);
    --btn-gradient: var(--gradient-secondary);
    --btn-color-500: var(--color-Secondary-500);
  }

  .opb-button--secondary:hover {
    background: var(--color-Secondary-500) !important;
    box-shadow: 0 4px 12px color-mix(in oklch, var(--color-Secondary-500), transparent 70%);
    border-color: transparent !important;
    color: var(--color-Background-50) !important;
  }

  .opb-button--secondary:active,
  .opb-button--secondary:focus {
    box-shadow: 0 2px 8px color-mix(in oklch, var(--color-Secondary-500), transparent 78%) inset;
    border-color: var(--color-Secondary-700);
    outline: none;
  }

  /* Accent variant */
  .opb-button--accent {
    background: transparent;
    border-color: var(--color-AccentFive-500);
    color: var(--color-AccentFive-500);
    --btn-gradient: var(--gradient-accent5);
    --btn-color-500: var(--color-AccentFive-500);
  }

  .opb-button--accent:hover {
    background: var(--color-AccentFive-500) !important;
    box-shadow: 0 4px 12px color-mix(in oklch, var(--color-AccentFive-500), transparent 70%);
    border-color: transparent !important;
    color: var(--color-Background-50) !important;
  }

  .opb-button--accent:active,
  .opb-button--accent:focus {
    box-shadow: 0 2px 8px color-mix(in oklch, var(--color-AccentFive-500), transparent 78%) inset;
    border-color: var(--color-AccentFive-700);
    outline: none;
  }

  /* Accent1 variant */
  .opb-button--accent1 {
    background: transparent;
    border-color: var(--color-AccentOne-500);
    color: var(--color-AccentOne-500);
    --btn-gradient: var(--gradient-accent1);
    --btn-color-500: var(--color-AccentOne-500);
  }

  .opb-button--accent1:hover {
    background: var(--color-AccentOne-500) !important;
    box-shadow: 0 4px 12px color-mix(in oklch, var(--color-AccentOne-500), transparent 70%);
    border-color: transparent !important;
    color: var(--color-Background-50) !important;
  }

  .opb-button--accent1:active,
  .opb-button--accent1:focus {
    box-shadow: 0 2px 8px color-mix(in oklch, var(--color-AccentOne-500), transparent 78%) inset;
    border-color: var(--color-AccentOne-700);
    outline: none;
  }

  /* Accent2 variant */
  .opb-button--accent2 {
    background: transparent;
    border-color: var(--color-AccentTwo-500);
    color: var(--color-AccentTwo-500);
    --btn-gradient: var(--gradient-accent2);
    --btn-color-500: var(--color-AccentTwo-500);
  }

  .opb-button--accent2:hover {
    background: var(--color-AccentTwo-500) !important;
    box-shadow: 0 4px 12px color-mix(in oklch, var(--color-AccentTwo-500), transparent 70%);
    border-color: transparent !important;
    color: var(--color-Background-50) !important;
  }

  .opb-button--accent2:active,
  .opb-button--accent2:focus {
    box-shadow: 0 2px 8px color-mix(in oklch, var(--color-AccentTwo-500), transparent 78%) inset;
    border-color: var(--color-AccentTwo-700);
    outline: none;
  }

  /* Accent3 variant */
  .opb-button--accent3 {
    background: transparent;
    border-color: var(--color-AccentThree-500);
    color: var(--color-AccentThree-500);
    --btn-gradient: var(--gradient-accent3);
    --btn-color-500: var(--color-AccentThree-500);
  }

  .opb-button--accent3:hover {
    background: var(--color-AccentThree-500) !important;
    box-shadow: 0 4px 12px color-mix(in oklch, var(--color-AccentThree-500), transparent 70%);
    border-color: transparent !important;
    color: var(--color-Background-50) !important;
  }

  .opb-button--accent3:active,
  .opb-button--accent3:focus {
    box-shadow: 0 2px 8px color-mix(in oklch, var(--color-AccentThree-500), transparent 78%) inset;
    border-color: var(--color-AccentThree-700);
    outline: none;
  }

  /* Accent4 variant */
  .opb-button--accent4 {
    background: transparent;
    border-color: var(--color-AccentFour-500);
    color: var(--color-AccentFour-500);
    --btn-gradient: var(--gradient-accent4);
    --btn-color-500: var(--color-AccentFour-500);
  }

  .opb-button--accent4:hover {
    background: var(--color-AccentFour-500) !important;
    box-shadow: 0 4px 12px color-mix(in oklch, var(--color-AccentFour-500), transparent 70%);
    border-color: transparent !important;
    color: var(--color-Background-50) !important;
  }

  .opb-button--accent4:active,
  .opb-button--accent4:focus {
    box-shadow: 0 2px 8px color-mix(in oklch, var(--color-AccentFour-500), transparent 78%) inset;
    border-color: var(--color-AccentFour-700);
    outline: none;
  }

  /* Accent5 variant */
  .opb-button--accent5 {
    background: transparent;
    border-color: var(--color-AccentFive-500);
    color: var(--color-AccentFive-500);
    --btn-gradient: var(--gradient-accent5);
    --btn-color-500: var(--color-AccentFive-500);
  }

  .opb-button--accent5:hover {
    background: var(--color-AccentFive-500) !important;
    box-shadow: 0 4px 12px color-mix(in oklch, var(--color-AccentFive-500), transparent 70%);
    border-color: transparent !important;
    color: var(--color-Background-50) !important;
  }

  .opb-button--accent5:active,
  .opb-button--accent5:focus {
    box-shadow: 0 2px 8px color-mix(in oklch, var(--color-AccentFive-500), transparent 78%) inset;
    border-color: var(--color-AccentFive-700);
    outline: none;
  }

  /* Glow variant - outline with enhanced glow on hover (token-aware) */
  .opb-button--glow {
    background: transparent;
    border-color: var(--btn-color-500, var(--color-Primary-500));
    color: var(--btn-color-500, var(--color-Primary-500));
  }

  .opb-button--glow:hover {
    background: var(--btn-color-500, var(--color-Primary-500)) !important;
    box-shadow: 0 6px 20px color-mix(in oklch, var(--btn-color-500, var(--color-Primary-500)), transparent 35%);
    border-color: transparent !important;
    color: var(--color-Background-50) !important;
  }

  .opb-button--glow:active,
  .opb-button--glow:focus {
    box-shadow: 0 2px 8px color-mix(in oklch, var(--btn-color-500, var(--color-Primary-500)), transparent 78%) inset;
    border-color: var(--btn-color-500, var(--color-Primary-500));
    outline: none;
  }

  /* Glass variant - glassmorphic with backdrop blur */
  .opb-button--glass {
    background: var(--glass-surface-bg);
    border-color: var(--btn-color-500, var(--color-Primary-500));
    color: var(--btn-color-500, var(--color-Primary-500));
    backdrop-filter: blur(var(--glass-surface-blur));
    -webkit-backdrop-filter: blur(var(--glass-surface-blur));
  }

  .opb-button--glass:hover {
    background: var(--glass-surface-bg) !important;
    border-color: var(--btn-color-500, var(--color-Primary-500)) !important;
    color: var(--btn-color-500, var(--color-Primary-500)) !important;
    backdrop-filter: blur(var(--glass-surface-blur));
    -webkit-backdrop-filter: blur(var(--glass-surface-blur));
    box-shadow: 0 4px 12px color-mix(in oklch, var(--btn-color-500, var(--color-Primary-500)), transparent 70%), inset 0 0 20px color-mix(in oklch, var(--btn-color-500, var(--color-Primary-500)), transparent 50%);
  }

  .opb-button--glass:active,
  .opb-button--glass:focus {
    background: var(--glass-surface-bg);
    box-shadow: 0 2px 8px color-mix(in oklch, var(--btn-color-500, var(--color-Primary-500)), transparent 50%) inset;
    border-color: var(--btn-color-500, var(--color-Primary-500));
    color: var(--btn-color-500, var(--color-Primary-500));
    outline: none;
    backdrop-filter: blur(var(--glass-surface-blur));
    -webkit-backdrop-filter: blur(var(--glass-surface-blur));
  }

  /* Gradient variant - static gradient outline, animated gradient fill with glow on hover */
  .opb-button--gradient {
    background: transparent;
    border-color: transparent;
    position: relative;
    background-image: var(--btn-gradient, var(--gradient-hero));
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    color: transparent;
  }

  .opb-button--gradient::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: inherit;
    padding: 2px;
    background: var(--btn-gradient, var(--gradient-hero));
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    pointer-events: none;
    z-index: 0;
  }

  .opb-button--gradient::after {
    content: '';
    position: absolute;
    inset: -2px;
    border-radius: inherit;
    background: var(--btn-gradient, var(--gradient-hero));
    background-size: 200% 200%;
    animation: gradientShift 3s ease infinite;
    opacity: 0;
    transition: opacity var(--transition-fast);
    z-index: -1;
    pointer-events: none;
  }

  .opb-button--gradient:hover {
    background: transparent !important;
    -webkit-text-fill-color: var(--color-Background-50) !important;
    color: var(--color-Background-50) !important;
    border-color: transparent !important;
    box-shadow: 0 4px 12px color-mix(in oklch, var(--btn-color-500, var(--color-Primary-500)), transparent 70%);
    z-index: 1;
  }

  .opb-button--gradient:hover::before {
    display: none;
  }

  .opb-button--gradient:hover::after {
    opacity: 1;
  }

  .opb-button--gradient:active,
  .opb-button--gradient:focus {
    background: transparent !important;
    -webkit-text-fill-color: var(--color-Background-50) !important;
    color: var(--color-Background-50) !important;
    border-color: transparent !important;
    box-shadow: 0 2px 8px color-mix(in oklch, var(--btn-color-500, var(--color-Primary-500)), transparent 78%) inset;
    outline: none;
    z-index: 1;
  }

  .opb-button--gradient:active::before,
  .opb-button--gradient:focus::before {
    display: none;
  }

  .opb-button--gradient:active::after,
  .opb-button--gradient:focus::after {
    opacity: 1;
    animation: none;
  }

  /* Gradient animation */
  @keyframes gradientShift {
    0% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
    100% {
      background-position: 0% 50%;
    }
  }

  /* Accent Filled variant */
  .opb-button--accent-filled {
    background: var(--color-AccentFive-100);
    border-color: var(--color-AccentFive-500);
    color: var(--color-AccentFive-800);
  }

  .opb-button--accent-filled:hover {
    background: var(--color-AccentFive-200);
    box-shadow: 0 4px 12px color-mix(in oklch, var(--color-AccentFive-500), transparent 70%);
    border-color: var(--color-AccentFive-600);
  }

  .opb-button--accent-filled:active,
  .opb-button--accent-filled:focus {
    background: var(--color-AccentFive-300);
    box-shadow: 0 2px 8px color-mix(in oklch, var(--color-AccentFive-500), transparent 78%) inset;
    border-color: var(--color-AccentFive-600);
    outline: none;
  }

  /* Ghost variant - token-aware */
  .opb-button--ghost {
    background: transparent;
    border-color: color-mix(in oklch, var(--btn-color-500, var(--color-Primary-500)), transparent 80%);
    color: var(--btn-color-500, var(--color-Primary-500));
  }

  .opb-button--ghost:hover {
    background: color-mix(in oklch, var(--btn-color-500, var(--color-Primary-500)), transparent 90%) !important;
    border-color: var(--btn-color-500, var(--color-Primary-500)) !important;
    color: var(--btn-color-500, var(--color-Primary-500)) !important;
  }

  .opb-button--ghost:active,
  .opb-button--ghost:focus {
    background: color-mix(in oklch, var(--btn-color-500, var(--color-Primary-500)), transparent 85%);
    border-color: var(--btn-color-500, var(--color-Primary-500));
    color: var(--btn-color-500, var(--color-Primary-500));
    outline: none;
  }

  /* Neumorphic variant - colored shadows on static, filled with white shadows on hover */
  .opb-button--neumorphic {
    background: transparent;
    border-color: var(--btn-color-500, var(--color-Primary-500));
    color: var(--btn-color-500, var(--color-Primary-500));
    box-shadow:
      inset 2px 2px 8px color-mix(in oklch, var(--btn-color-500, var(--color-Primary-500)), transparent 60%),
      inset -2px -2px 8px color-mix(in oklch, var(--btn-color-500, var(--color-Primary-500)), transparent 70%),
      0 4px 12px rgba(0, 0, 0, 0.15);
  }

  .opb-button--neumorphic:hover {
    background: var(--btn-color-500, var(--color-Primary-500)) !important;
    border-color: transparent !important;
    color: var(--color-Background-50) !important;
    box-shadow:
      inset 3px 3px 10px rgba(0, 0, 0, 0.4),
      inset -3px -3px 10px rgba(255, 255, 255, 0.5);
  }

  .opb-button--neumorphic:active,
  .opb-button--neumorphic:focus {
    background: var(--btn-color-500, var(--color-Primary-500));
    border-color: transparent;
    color: var(--color-Background-50);
    box-shadow:
      inset 4px 4px 12px rgba(0, 0, 0, 0.5),
      inset -4px -4px 12px rgba(255, 255, 255, 0.4);
    outline: none;
  }

  /* Keep hover state when dropdown is open */
  .dropdown-wrapper.open .opb-button--primary,
  .dropdown-wrapper.open .opb-button--secondary,
  .dropdown-wrapper.open .opb-button--accent,
  .dropdown-wrapper.open .opb-button--accent1,
  .dropdown-wrapper.open .opb-button--accent2,
  .dropdown-wrapper.open .opb-button--accent3,
  .dropdown-wrapper.open .opb-button--accent4,
  .dropdown-wrapper.open .opb-button--accent5 {
    background: var(--btn-color-500, var(--color-Primary-500)) !important;
    box-shadow: 0 4px 12px color-mix(in oklch, var(--btn-color-500, var(--color-Primary-500)), transparent 70%);
    border-color: transparent !important;
    color: var(--color-Background-50) !important;
  }

  .dropdown-wrapper.open .opb-button--gradient {
    background: transparent !important;
    -webkit-text-fill-color: var(--color-Background-50) !important;
    color: var(--color-Background-50) !important;
    border-color: transparent !important;
    box-shadow: 0 4px 12px color-mix(in oklch, var(--btn-color-500, var(--color-Primary-500)), transparent 70%);
    z-index: 1;
  }

  .dropdown-wrapper.open .opb-button--gradient::before {
    display: none;
  }

  .dropdown-wrapper.open .opb-button--gradient::after {
    opacity: 1;
  }

  .dropdown-wrapper.open .opb-button--glass {
    background: var(--glass-surface-bg);
    box-shadow: var(--shadow-glass);
    border-color: transparent !important;
    color: var(--btn-color-500, var(--color-Primary-500));
  }

  .dropdown-wrapper.open .opb-button--neumorphic {
    background: var(--btn-color-500, var(--color-Primary-500)) !important;
    border-color: transparent !important;
    color: var(--color-Background-50) !important;
    box-shadow:
      inset 3px 3px 10px rgba(0, 0, 0, 0.4),
      inset -3px -3px 10px rgba(255, 255, 255, 0.5);
  }

  .dropdown-wrapper.open .opb-button--glow {
    background: var(--btn-color-500, var(--color-Primary-500)) !important;
    box-shadow: 0 6px 20px color-mix(in oklch, var(--btn-color-500, var(--color-Primary-500)), transparent 35%);
    border-color: transparent !important;
    color: var(--color-Background-50) !important;
  }

  /* Disabled State */
  .opb-container:has(.opb-button--disabled) {
    cursor: not-allowed;
  }

  .opb-button--disabled {
    opacity: 0.5;
    pointer-events: none !important;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .opb-container {
      height: 80px;
    }

    .opb-button {
      min-width: 160px;
      max-width: 280px;
    }
  }

  /* Size Variants for Default Shape Buttons */
  .opb-button--sm:not(.opb-button--round):not(.opb-button--square) {
    padding: var(--btn-size-sm-padding) !important;
    font-size: var(--btn-size-sm-font-size) !important;
    min-height: var(--btn-size-sm-min-height) !important;
  }

  .opb-button--lg:not(.opb-button--round):not(.opb-button--square) {
    padding: var(--btn-size-lg-padding) !important;
    font-size: var(--btn-size-lg-font-size) !important;
    min-height: var(--btn-size-lg-min-height) !important;
  }

  /* Shape Variants - Default (Medium) Size */
  .opb-button--round {
    border-radius: 50% !important;
    min-width: 48px !important;
    width: 48px !important;
    height: 48px !important;
    min-height: 48px !important;
    padding: 0 !important;
    font-size: var(--font-size-lg) !important;
  }

  .opb-button--square {
    border-radius: 4px !important;
    min-width: 48px !important;
    width: 48px !important;
    height: 48px !important;
    min-height: 48px !important;
    padding: 0 !important;
    font-size: var(--font-size-lg) !important;
  }

  /* Size Variants for Round Buttons */
  .opb-button--round.opb-button--sm {
    min-width: 36px !important;
    width: 36px !important;
    height: 36px !important;
    min-height: 36px !important;
    font-size: var(--font-size-sm) !important;
  }

  .opb-button--round.opb-button--lg {
    min-width: 64px !important;
    width: 64px !important;
    height: 64px !important;
    min-height: 64px !important;
    font-size: var(--font-size-xl) !important;
  }

  /* Size Variants for Square Buttons */
  .opb-button--square.opb-button--sm {
    min-width: 36px !important;
    width: 36px !important;
    height: 36px !important;
    min-height: 36px !important;
    font-size: var(--font-size-sm) !important;
  }

  .opb-button--square.opb-button--lg {
    min-width: 64px !important;
    width: 64px !important;
    height: 64px !important;
    min-height: 64px !important;
    font-size: var(--font-size-xl) !important;
  }

  /* Radius Variants - only apply to default shape buttons */
  .opb-button--default.opb-button--radius-sharp {
    border-radius: 0px !important;
  }

  .opb-button--default.opb-button--radius-default {
    border-radius: 8px !important;
  }

  .opb-button--default.opb-button--radius-soft {
    border-radius: 16px !important;
  }

  .opb-button--default.opb-button--radius-pill {
    border-radius: 50px !important;
  }

  /* For buttons without explicit shape specified, still apply radius */
  .opb-button--radius-sharp:not(.opb-button--round):not(.opb-button--square) {
    border-radius: 0px !important;
  }

  .opb-button--radius-soft:not(.opb-button--round):not(.opb-button--square) {
    border-radius: 16px !important;
  }

  .opb-button--radius-pill:not(.opb-button--round):not(.opb-button--square) {
    border-radius: 50px !important;
  }

  /* Round and square buttons on mobile */
  @media (max-width: 768px) {
    .opb-button--round,
    .opb-button--square {
      min-width: 44px !important;
      width: 44px !important;
      height: 44px !important;
      min-height: 44px !important;
      font-size: var(--font-size-base) !important;
    }

    .opb-button--round.opb-button--sm,
    .opb-button--square.opb-button--sm {
      min-width: 32px !important;
      width: 32px !important;
      height: 32px !important;
      min-height: 32px !important;
      font-size: var(--font-size-xs) !important;
    }

    .opb-button--round.opb-button--lg,
    .opb-button--square.opb-button--lg {
      min-width: 56px !important;
      width: 56px !important;
      height: 56px !important;
      min-height: 56px !important;
      font-size: var(--font-size-lg) !important;
    }
  }

  /* Icon Styles */
  .opb-icon {
    width: 20px;
    height: 20px;
    display: block;
    transition: transform 0.3s ease;
  }

  .opb-icon svg {
    width: 100%;
    height: 100%;
    display: block;
  }

  .opb-button--round .opb-icon,
  .opb-button--square .opb-icon {
    width: 24px;
    height: 24px;
  }

  /* Icon sizes for different button sizes */
  .opb-button--sm .opb-icon {
    width: 18px !important;
    height: 18px !important;
  }

  .opb-button--lg .opb-icon {
    width: 32px !important;
    height: 32px !important;
  }

  /* Icon Hover Animations */
  .opb-button--round:hover .opb-icon {
    transform: rotate(180deg) scale(1.1);
  }

  .opb-button--square:hover .opb-icon {
    transform: scale(1.2) rotate(90deg);
  }

  /* Icon Colors Match Border Colors - Using Same Design Tokens */
  .opb-button--primary .opb-icon svg {
    stroke: var(--color-Primary-500);
    transition: stroke var(--transition-fast);
  }

  .opb-button--primary:hover .opb-icon svg,
  .opb-button--primary:active .opb-icon svg {
    stroke: var(--color-Background-50);
  }

  .opb-button--secondary .opb-icon svg {
    stroke: var(--color-Secondary-500);
    transition: stroke var(--transition-fast);
  }

  .opb-button--secondary:hover .opb-icon svg,
  .opb-button--secondary:active .opb-icon svg {
    stroke: var(--color-Background-50);
  }

  .opb-button--accent .opb-icon svg {
    stroke: var(--color-AccentFive-500);
    transition: stroke var(--transition-fast);
  }

  .opb-button--accent:hover .opb-icon svg,
  .opb-button--accent:active .opb-icon svg {
    stroke: var(--color-Background-50);
  }

  .opb-button--accent1 .opb-icon svg {
    stroke: var(--color-AccentOne-500);
    transition: stroke var(--transition-fast);
  }

  .opb-button--accent1:hover .opb-icon svg,
  .opb-button--accent1:active .opb-icon svg {
    stroke: var(--color-Background-50);
  }

  .opb-button--accent2 .opb-icon svg {
    stroke: var(--color-AccentTwo-500);
    transition: stroke var(--transition-fast);
  }

  .opb-button--accent2:hover .opb-icon svg,
  .opb-button--accent2:active .opb-icon svg {
    stroke: var(--color-Background-50);
  }

  .opb-button--accent3 .opb-icon svg {
    stroke: var(--color-AccentThree-500);
    transition: stroke var(--transition-fast);
  }

  .opb-button--accent3:hover .opb-icon svg,
  .opb-button--accent3:active .opb-icon svg {
    stroke: var(--color-Background-50);
  }

  .opb-button--accent4 .opb-icon svg {
    stroke: var(--color-AccentFour-500);
    transition: stroke var(--transition-fast);
  }

  .opb-button--accent4:hover .opb-icon svg,
  .opb-button--accent4:active .opb-icon svg {
    stroke: var(--color-Background-50);
  }

  .opb-button--accent5 .opb-icon svg {
    stroke: var(--color-AccentFive-500);
    transition: stroke var(--transition-fast);
  }

  .opb-button--accent5:hover .opb-icon svg,
  .opb-button--accent5:active .opb-icon svg {
    stroke: var(--color-Background-50);
  }

  .opb-button--glow .opb-icon svg {
    stroke: var(--color-Primary-500);
    transition: stroke var(--transition-fast);
  }

  .opb-button--glow:hover .opb-icon svg,
  .opb-button--glow:active .opb-icon svg {
    stroke: var(--color-Background-50);
  }

  .opb-button--glass .opb-icon svg {
    stroke: var(--btn-color-500, var(--color-Primary-500));
    transition: stroke var(--transition-fast);
  }

  .opb-button--neumorphic .opb-icon svg {
    stroke: var(--color-Text-700);
    transition: stroke var(--transition-fast);
  }

  .opb-button--gradient .opb-icon svg {
    stroke: var(--color-Text-700);
    transition: stroke var(--transition-fast);
  }

  .opb-button--gradient:hover .opb-icon svg,
  .opb-button--gradient:active .opb-icon svg {
    stroke: var(--color-Background-50);
  }

  .opb-button--accent-filled .opb-icon svg {
    stroke: var(--color-AccentFive-500);
    transition: stroke var(--transition-fast);
  }

  .opb-button--accent-filled:hover .opb-icon svg,
  .opb-button--accent-filled:active .opb-icon svg {
    stroke: var(--color-Background-50);
  }

  /* Dropdown Styles */
  .dropdown-wrapper {
    position: relative;
    display: inline-block;
  }

  .opb-dropdown {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 8px !important;
    text-decoration: none !important;
    cursor: pointer !important;
    outline: none;
    width: auto;
    min-width: fit-content;
    min-height: var(--btn-size-default-min-height);
    padding: var(--btn-size-default-padding);
    border-radius: var(--radius-md);
    border-width: 2px;
    border-style: solid;
    box-sizing: border-box;
    transition: all var(--transition-fast);
    font-family: var(--font-body);
    font-size: var(--btn-size-default-font-size);
    font-weight: var(--font-weight-medium);
    text-transform: uppercase;
    letter-spacing: 0.075em;
    text-shadow: none;
    box-shadow: none;
    text-align: center;
    white-space: normal;
    word-wrap: break-word;
  }

  .dropdown-chevron {
    width: 16px;
    height: 16px;
    transition: transform var(--transition-fast);
  }

  .dropdown-wrapper.open .dropdown-chevron {
    transform: rotate(180deg);
  }

  /* Reduce motion */
  @media (prefers-reduced-motion: reduce) {
    .opb-button,
    .dropdown-chevron,
    .opb-icon {
      transition: none !important;
    }

    .opb-button--round:hover .opb-icon,
    .opb-button--square:hover .opb-icon {
      transform: none !important;
    }
  }
</style>

<script is:inline>
  document.addEventListener('DOMContentLoaded', function() {
    // Handle all dropdown buttons on the page
    const dropdownWrappers = document.querySelectorAll('.dropdown-wrapper');

    dropdownWrappers.forEach((wrapper) => {
      const dropdownBtn = wrapper.querySelector('.dropdown-btn');
      const dropdownMenu = wrapper.querySelector('.themed-dropdown-menu');

      if (dropdownBtn && dropdownMenu) {
        dropdownBtn.addEventListener('click', function(e) {
          e.preventDefault();

          // Close all other dropdowns first
          dropdownWrappers.forEach(otherWrapper => {
            if (otherWrapper !== wrapper) {
              const otherMenu = otherWrapper.querySelector('.themed-dropdown-menu');
              if (otherMenu) {
                otherMenu.classList.remove('show');
                otherWrapper.classList.remove('open');
              }
            }
          });

          // Toggle current dropdown
          const isShowing = dropdownMenu.classList.contains('show');

          if (!isShowing) {
            dropdownMenu.classList.add('show');
            wrapper.classList.add('open');
          } else {
            dropdownMenu.classList.remove('show');
            wrapper.classList.remove('open');
          }
        });
      }
    });

    // Close dropdown when clicking outside
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.dropdown-wrapper')) {
        dropdownWrappers.forEach(wrapper => {
          const menu = wrapper.querySelector('.themed-dropdown-menu');
          if (menu) {
            menu.classList.remove('show');
            wrapper.classList.remove('open');
          }
        });
      }
    });
  });
</script>

