---
import { Image } from 'astro:assets';
import Button from '../Button/Button.astro';
import Icon from '../Icons/Icon.astro';

interface Slide {
  id: string;
  title: string;
  image: string;
  imageAlt: string;
  content: string;
}

interface Props {
  title: string;
  subtitle: string;
  titleImage: ImageMetadata;
  slides: Slide[];
  slideImages: ImageMetadata[];
}

const { title, subtitle, titleImage, slides, slideImages } = Astro.props;
---

<section class="who-slider section">
  <div class="who-slider__wrapper">
    <div class="who-slider__track js-who-slider">
      <!-- Slide 1: Title Card -->
      <div class="who-slider__slide">
        <div class="card who-slider__title-card">
          <div class="who-slider__title-image">
            <Image src={titleImage} alt="Contemplative figure looking toward hope" loading="lazy" />
          </div>
          <div class="who-slider__title-content">
            <h2 class="who-slider__title">{title}</h2>
            <p class="who-slider__subtitle" set:html={subtitle}></p>
            <div class="who-slider__card-nav">
              <Button href="#" variant="primary" className="js-who-next">Explore Further</Button>
            </div>
          </div>
        </div>
      </div>

      <!-- Content Slides -->
      {slides.map((slide, index) => (
        <div class="who-slider__slide">
          <div class="card who-slider__card">
            <div class="who-slider__card-image">
              <Image src={slideImages[index]} alt={slide.imageAlt} loading="lazy" />
            </div>
            <div class="who-slider__card-content">
              <h3 class="who-slider__card-title">{slide.title}</h3>
              <p class="who-slider__card-text">{slide.content}</p>
              <div class="who-slider__card-nav">
                <Button variant="primary" shape="square" ariaLabel="Previous slide" className="who-slider__nav-btn js-who-prev">
                  <Icon slot="icon" name="caret-left-fill" size={20} />
                </Button>
                <Button variant="primary" shape="square" ariaLabel="Next slide" className="who-slider__nav-btn js-who-next">
                  <Icon slot="icon" name="caret-right-fill" size={20} />
                </Button>
              </div>
            </div>
          </div>
        </div>
      ))}
    </div>

    <!-- Slider Navigation -->
    <Button
      variant="primary"
      shape="square"
      ariaLabel="Previous slide"
      className="who-slider__controls who-slider__controls--prev js-who-prev"
    >
      <Icon slot="icon" name="caret-left-fill" size={24} />
    </Button>
    <Button
      variant="primary"
      shape="square"
      ariaLabel="Next slide"
      className="who-slider__controls who-slider__controls--next js-who-next"
    >
      <Icon slot="icon" name="caret-right-fill" size={24} />
    </Button>

    <!-- Slider Indicators -->
    <div class="who-slider__indicators">
      <button class="who-slider__dot is-active js-who-dot" data-slide="0" aria-label="Go to slide 1"></button>
      {slides.map((_, index) => (
        <button class="who-slider__dot js-who-dot" data-slide={index + 1} aria-label={`Go to slide ${index + 2}`}></button>
      ))}
    </div>
  </div>
</section>

<script src="../../lib/ui/who-slider.ts"></script>
