---
/**
 * PillarsSection - Reusable three-column pillars/features section
 *
 * Props:
 * - title: Section heading
 * - description?: Section description
 * - pillars: Array of {icon?, image?, title, description}
 * - bgClass?: Background class
 */

import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

export interface Pillar {
  icon?: string; // SVG string (optional)
  image?: ImageMetadata | string; // Image import or path (optional)
  title: string;
  description: string;
}

export interface Props {
  title: string;
  description?: string;
  pillars: Pillar[];
  bgClass?: string;
}

const {
  title,
  description,
  pillars,
  bgClass = 'bg-alt'
} = Astro.props;
---

<section class={`pillars-section section ${bgClass}`}>
  <div class="container container-7xl">
    <div class="pillars-section__header text-center">
      <h2 class="pillars-section__title">{title}</h2>
      {description && <p class="pillars-section__description">{description}</p>}
    </div>

    <div class="pillars-section__grid">
      {pillars.map(pillar => (
        <div class="pillars-section__card">
          {pillar.image ? (
            <div class="pillars-section__image-container">
              {typeof pillar.image !== 'string' ? (
                <Image src={pillar.image as ImageMetadata} alt={pillar.title} class="pillars-section__image" />
              ) : (
                <img src={pillar.image} alt={pillar.title} class="pillars-section__image" />
              )}
            </div>
          ) : pillar.icon ? (
            <div class="pillars-section__icon" set:html={pillar.icon}></div>
          ) : null}
          <h3 class="pillars-section__card-title">{pillar.title}</h3>
          <p class="pillars-section__card-description">{pillar.description}</p>
        </div>
      ))}
    </div>

    <slot />
  </div>
</section>

<style>
  .pillars-section {
    padding: var(--space-4xl) 0;
  }

  .pillars-section__header {
    margin-bottom: var(--space-3xl);
  }

  .pillars-section__title {
    font-size: var(--text-4xl);
    font-weight: var(--font-bold);
    margin-bottom: var(--space-md);
    color: var(--color-Text-700);
    font-family: var(--font-heading);
  }

  .pillars-section__description {
    font-size: var(--text-lg);
    color: var(--color-Text-500);
    max-width: 700px;
    margin: 0 auto;
    font-weight: var(--font-medium);
    font-family: var(--font-body);
  }

  .pillars-section__grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-3xl);
  }

  .pillars-section__card {
    text-align: center;
    transition: transform var(--transition-base);
  }

  .pillars-section__card:hover {
    transform: translateY(-4px);
  }

  .pillars-section__image-container {
    margin-bottom: var(--space-xl);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .pillars-section__image {
    width: 100%;
    height: auto;
    max-width: 300px;
    object-fit: contain;
    background: var(--color-Background-50);
    padding: var(--space-md);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-lg);
    transition: box-shadow var(--transition-base), transform var(--transition-base);
  }

  .pillars-section__card:hover .pillars-section__image {
    box-shadow: var(--shadow-xl);
    transform: translateY(-4px);
  }

  .pillars-section__icon {
    color: var(--color-Primary-500);
    margin-bottom: var(--space-xl);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .pillars-section__card-title {
    font-size: var(--text-2xl);
    font-weight: var(--font-semibold);
    margin-bottom: var(--space-md);
    color: var(--color-Text-700);
    font-family: var(--font-heading);
  }

  .pillars-section__card-description {
    color: var(--color-Text-600);
    line-height: var(--leading-relaxed);
    font-size: var(--text-lg);
    font-weight: var(--font-medium);
    font-family: var(--font-body);
  }

  @media (max-width: 767px) {
    .pillars-section {
      padding: var(--space-3xl) 0;
    }
  }

  @media (min-width: 768px) {
    .pillars-section__grid {
      grid-template-columns: repeat(3, 1fr);
      gap: var(--space-3xl);
    }
  }

  @media (min-width: 1024px) {
    .pillars-section__title {
      font-size: var(--text-5xl);
    }
  }

  @media (max-width: 250px) {
    .pillars-section {
      padding: var(--space-2xl) 0.25rem;
    }

    .pillars-section__header {
      margin-bottom: var(--space-lg);
    }

    .pillars-section__title {
      font-size: var(--text-lg);
      margin-bottom: var(--space-sm);
    }

    .pillars-section__description {
      font-size: var(--text-xs);
      line-height: 1.5;
    }

    .pillars-section__grid {
      gap: var(--space-lg);
    }

    .pillars-section__image-container {
      margin-bottom: var(--space-md);
    }

    .pillars-section__image {
      max-width: 180px;
    }

    .pillars-section__card-title {
      font-size: var(--text-sm);
      margin-bottom: var(--space-xs);
    }

    .pillars-section__card-description {
      font-size: var(--text-xs);
      line-height: 1.4;
    }
  }
</style>
