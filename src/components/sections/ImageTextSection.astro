---
/**
 * ImageTextSection - Reusable image + text section component
 *
 * Props:
 * - title: Section heading
 * - content: Array of text paragraphs or slot content
 * - image: Image import (ImageMetadata) or URL string
 * - imageAlt: Image alt text
 * - imagePosition?: 'left' | 'right'
 * - ctaText?: CTA button text
 * - ctaHref?: CTA button link
 * - bgClass?: Background class (e.g., 'bg-alt')
 */

import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';
import UnifiedButton from '../Buttons/UnifiedButton.astro';

export interface Props {
  title: string;
  content?: string[];
  image: ImageMetadata | string;
  imageAlt: string;
  imagePosition?: 'left' | 'right';
  ctaText?: string;
  ctaHref?: string;
  bgClass?: string;
}

const {
  title,
  content = [],
  image,
  imageAlt,
  imagePosition = 'left',
  ctaText,
  ctaHref,
  bgClass = ''
} = Astro.props;

const isImageMetadata = typeof image !== 'string';
---

<section class={`image-text-section section ${bgClass}`}>
  <div class="container container-7xl">
    <div class={`image-text-layout ${imagePosition === 'right' ? 'reverse' : ''}`}>
      <!-- Image -->
      <div class="image-container">
        {isImageMetadata ? (
          <Image src={image as ImageMetadata} alt={imageAlt} />
        ) : (
          <img src={image as string} alt={imageAlt} />
        )}
      </div>

      <!-- Text Content -->
      <div class="text-container">
        <h2 class="section-title">{title}</h2>

        {content.length > 0 && (
          <div class="text-body">
            {content.map(paragraph => (
              <p>{paragraph}</p>
            ))}
          </div>
        )}

        <slot />

        {ctaText && ctaHref && (
          <UnifiedButton href={ctaHref} variant="primary">{ctaText}</UnifiedButton>
        )}
      </div>
    </div>
  </div>
</section>

<style>
  .image-text-section {
    padding: var(--space-4xl) 0;
    padding-top: var(--space-5xl); /* Extra top padding to prevent overlap with hero */
    position: relative;
    z-index: 1;
  }

  .image-text-layout {
    display: flex;
    flex-direction: column;
    gap: var(--space-3xl);
    align-items: center;
  }

  .image-container {
    width: 100%;
    max-width: 500px;
    aspect-ratio: 1;
    border-radius: var(--border-radius-lg);
    overflow: hidden;
    box-shadow: var(--shadow-lg);
    transition: box-shadow var(--transition-base), transform var(--transition-base);
  }

  .image-container:hover {
    box-shadow: var(--shadow-xl);
    transform: scale(1.02);
  }

  .image-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .text-container {
    flex: 1 1 70%;
  }

  .section-title {
    font-size: var(--text-4xl);
    font-weight: var(--font-bold);
    margin-bottom: var(--space-xl);
    color: var(--color-Text-700);
  }

  .text-body {
    margin-bottom: var(--space-xl);
  }

  .text-body p {
    font-size: var(--text-xl);
    color: var(--color-Text-500);
    line-height: var(--leading-relaxed);
    margin-bottom: var(--space-lg);
    font-weight: var(--font-medium);
  }

  .text-body p:last-child {
    margin-bottom: 0;
  }

  @media (max-width: 767px) {
    .image-text-section {
      padding: var(--space-3xl) 0;
    }
  }

  @media (min-width: 768px) {
    .image-text-layout {
      flex-direction: row;
    }

    .image-text-layout.reverse {
      flex-direction: row-reverse;
    }

    .image-container {
      flex: 0 0 30%;
      max-width: 350px;
    }

    .section-title {
      font-size: var(--text-5xl);
    }
  }

  @media (max-width: 250px) {
    .image-text-section {
      padding: var(--space-2xl) 0.25rem;
      padding-top: var(--space-3xl);
    }

    .text-container {
      text-align: center;
    }

    .section-title {
      font-size: var(--text-xl);
      margin-bottom: var(--space-md);
    }

    .text-body p {
      font-size: var(--text-base);
      line-height: var(--leading-relaxed);
      margin-bottom: var(--space-sm);
    }

    .image-container {
      max-width: 180px;
    }
  }

  /* Extra small screens - under 210px */
  @media (max-width: 210px) {
    .image-text-section {
      padding: var(--space-lg) 0.125rem;
      padding-top: var(--space-2xl);
    }

    .section-title {
      font-size: var(--text-lg);
    }

    .text-body p {
      font-size: var(--text-sm);
    }

    .image-container {
      max-width: 140px;
    }
  }
</style>
