---
/**
 * Announcement Ticker - Scrolling text banner for announcements
 * Can be positioned at top or bottom of page
 *
 * CSS Standards Compliant:
 * - BEM-lite naming (.announcement-ticker, .announcement-ticker__track, etc)
 * - Global typography - no font overrides
 * - All design tokens from tokens/ folder
 * - No hardcoded values
 */
import Icon from '../Icons/Icon.astro';

interface TickerItem {
  text: string;
  icon?: 'info' | 'warning' | 'heart' | 'star' | 'gift' | 'calendar' | 'megaphone' | 'sparkle' | 'none';
  link?: string;
}

interface Props {
  items?: TickerItem[];
  position?: 'top' | 'bottom';
  speed?: number; // seconds for one complete cycle
  backgroundColor?: 'primary' | 'secondary' | 'accent' | 'dark' | 'light';
  pauseOnHover?: boolean;
  enabled?: boolean;
}

const {
  items = [
    { text: 'Welcome to our website!', icon: 'sparkle' },
    { text: 'Free shipping on orders over $50', icon: 'gift' },
    { text: 'New arrivals just dropped', icon: 'star' },
  ],
  position = 'top',
  speed = 25,
  backgroundColor = 'primary',
  pauseOnHover = true,
  enabled = true
} = Astro.props;

// Map icon names to Phosphor icon paths
const iconMap: Record<string, string> = {
  info: 'announcement-ticker/info-fill',
  warning: 'announcement-ticker/warning-fill',
  heart: 'announcement-ticker/heart-fill',
  star: 'announcement-ticker/star-fill',
  gift: 'announcement-ticker/gift-fill',
  calendar: 'announcement-ticker/calendar-fill',
  megaphone: 'announcement-ticker/megaphone-fill',
  sparkle: 'announcement-ticker/sparkle-fill',
};
---

{enabled && (
  <div
    class={`announcement-ticker announcement-ticker--${position} announcement-ticker--${backgroundColor} ${pauseOnHover ? 'announcement-ticker--pause-hover' : ''}`}
    data-speed={speed}
  >
    <div class="announcement-ticker__track">
      <!-- Duplicate content for seamless loop -->
      {[0, 1].map(() => (
        <div class="announcement-ticker__segment">
          {items.map((item) => (
            item.link ? (
              <a href={item.link} class="announcement-ticker__item announcement-ticker__item--link">
                {item.icon && item.icon !== 'none' && iconMap[item.icon] && (
                  <Icon name={iconMap[item.icon]} size={16} class="announcement-ticker__icon" />
                )}
                <span class="announcement-ticker__text">{item.text}</span>
              </a>
            ) : (
              <span class="announcement-ticker__item">
                {item.icon && item.icon !== 'none' && iconMap[item.icon] && (
                  <Icon name={iconMap[item.icon]} size={16} class="announcement-ticker__icon" />
                )}
                <span class="announcement-ticker__text">{item.text}</span>
              </span>
            )
          ))}
        </div>
      ))}
    </div>
  </div>
)}

<script>
  import '../../scripts/announcement-ticker.ts';
</script>

<!-- CSS extracted to: src/styles/components/announcement-ticker.css -->
