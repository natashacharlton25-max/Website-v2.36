---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

interface Props {
  mainImage: ImageMetadata;
  galleryImages?: ImageMetadata[];
  productName: string;
  badge?: string;
  badgeType?: string;
}

const { mainImage, galleryImages = [], productName, badge, badgeType = 'default' } = Astro.props;

// Combine into single array - use galleryImages if available, otherwise use mainImage
const allImages = galleryImages && galleryImages.length > 0
  ? galleryImages
  : [mainImage];

const galleryId = `gallery-${Math.random().toString(36).slice(2, 9)}`;
---

<div class="isotope-gallery-wrapper">
  <div class="isotope-gallery" id={galleryId}>
    {allImages.map((img, index) => (
      <div class={`gallery-item ${index === 0 ? 'is-expanded' : ''}`} data-index={index}>
        <Image src={img} alt={`${productName} image ${index + 1}`} />
        {badge && (
          <div class={`product-badge badge-${badgeType}`} style={index === 0 ? '' : 'display: none;'}>{badge}</div>
        )}
      </div>
    ))}
  </div>
</div>

<script>
  import '../../lib/ui/isotope-gallery';
</script>

<!-- CSS extracted to: src/styles/components/isotope-gallery.css -->
